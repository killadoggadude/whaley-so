module.exports=[93509,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(73320),e=a.i(33508),f=a.i(70106);let g=(0,f.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var h=a.i(92e3),i=a.i(96221),j=a.i(99570),k=a.i(68114),l=a.i(23292);function m({onUploadComplete:a}){let[f,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(!1),r=(0,c.useRef)(null),s=(0,c.useCallback)(a=>{let b=Array.from(a).map(a=>({file:a,status:"pending"}));o(a=>[...a,...b])},[]),t=(0,c.useCallback)(a=>{a.preventDefault(),m(!1),a.dataTransfer.files.length>0&&s(a.dataTransfer.files)},[s]),u=async()=>{q(!0);let b=0;for(let a=0;a<n.length;a++)if("done"!==n[a].status){o(b=>b.map((b,c)=>c===a?{...b,status:"uploading"}:b));try{let c=new FormData;c.append("file",n[a].file);let d=await fetch("/api/assets/upload",{method:"POST",body:c});if(!d.ok){let a=await d.json();throw Error(a.error||"Upload failed")}o(b=>b.map((b,c)=>c===a?{...b,status:"done"}:b)),b++}catch(b){o(c=>c.map((c,d)=>d===a?{...c,status:"error",error:b instanceof Error?b.message:"Upload failed"}:c))}}q(!1),b>0&&(l.toast.success(`Uploaded ${b} file${b>1?"s":""}`),a())},v=n.filter(a=>"done"!==a.status);return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:(0,k.cn)("rounded-lg border-2 border-dashed p-8 text-center cursor-pointer transition-colors",f?"border-accent-blue bg-accent-blue/5":"border-muted-foreground/25 hover:border-muted-foreground/50"),onDragOver:a=>{a.preventDefault(),m(!0)},onDragLeave:()=>m(!1),onDrop:t,onClick:()=>r.current?.click(),children:[(0,b.jsx)(d.Upload,{className:"h-8 w-8 mx-auto text-muted-foreground mb-2"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Drag & drop files here, or click to browse"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Images, audio, video, PDF. Max 50MB each."}),(0,b.jsx)("input",{ref:r,type:"file",multiple:!0,accept:"image/*,audio/*,video/*,application/pdf",className:"hidden",onChange:a=>{a.target.files&&s(a.target.files),a.target.value=""}})]}),n.length>0&&(0,b.jsxs)("div",{className:"space-y-2",children:[n.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-3 rounded-md border px-3 py-2 text-sm",children:["uploading"===a.status&&(0,b.jsx)(i.Loader2,{className:"h-4 w-4 animate-spin text-muted-foreground"}),"done"===a.status&&(0,b.jsx)(g,{className:"h-4 w-4 text-green-500"}),"error"===a.status&&(0,b.jsx)(h.AlertCircle,{className:"h-4 w-4 text-destructive"}),"pending"===a.status&&(0,b.jsx)("div",{className:"h-4 w-4 rounded-full border-2 border-muted-foreground/30"}),(0,b.jsx)("span",{className:"flex-1 truncate",children:a.file.name}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:(0,k.formatFileSize)(a.file.size)}),a.error&&(0,b.jsx)("span",{className:"text-xs text-destructive",children:a.error}),"uploading"!==a.status&&"done"!==a.status&&(0,b.jsx)(j.Button,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0",onClick:()=>{o(a=>a.filter((a,b)=>b!==c))},children:(0,b.jsx)(e.X,{className:"h-3 w-3"})})]},c)),v.length>0&&(0,b.jsx)(j.Button,{onClick:u,disabled:p,className:"w-full",children:p?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Uploading..."]}):`Upload ${v.length} file${v.length>1?"s":""}`}),n.length>0&&!p&&(0,b.jsx)(j.Button,{variant:"ghost",size:"sm",onClick:()=>o([]),className:"w-full",children:"Clear"})]})]})}var n=a.i(66718),o=a.i(80701),p=a.i(21374);let q=(0,f.default)("layout-grid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]),r=(0,f.default)("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]);var s=a.i(87532),t=a.i(87534);let u=[{label:"All",value:"all"},{label:"Images",value:"image"},{label:"Audio",value:"audio"},{label:"Video",value:"video"},{label:"Documents",value:"document"}];function v({search:a,onSearchChange:c,fileType:d,onFileTypeChange:e,favoritesOnly:f,onFavoritesToggle:g,sortBy:h,onSortChange:i,viewMode:l,onViewModeChange:m,aiModels:v,selectedModelId:w,onModelChange:x,selectionMode:y,onSelectionModeToggle:z}){return(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,b.jsxs)("div",{className:"relative flex-1 min-w-[200px]",children:[(0,b.jsx)(s.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(n.Input,{placeholder:"Search files...",value:a,onChange:a=>c(a.target.value),className:"pl-9"})]}),(0,b.jsx)("div",{className:"flex rounded-md border border-border",children:u.map(a=>(0,b.jsx)(j.Button,{variant:"ghost",size:"sm",className:(0,k.cn)("rounded-none text-xs",("all"!==a.value||d)&&a.value!==d?"":"bg-muted"),onClick:()=>e("all"===a.value?void 0:a.value),children:a.label},a.value))}),v.length>0&&(0,b.jsxs)(o.Select,{value:w||"all",onValueChange:a=>x("all"===a||"__unassigned__"===a?void 0:a),children:[(0,b.jsx)(o.SelectTrigger,{className:"w-[160px]",children:(0,b.jsx)(o.SelectValue,{placeholder:"All Models"})}),(0,b.jsxs)(o.SelectContent,{children:[(0,b.jsx)(o.SelectItem,{value:"all",children:"All Models"}),(0,b.jsx)(o.SelectItem,{value:"__unassigned__",children:"Unassigned"}),v.map(a=>(0,b.jsx)(o.SelectItem,{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)(j.Button,{variant:f?"default":"outline",size:"sm",onClick:g,children:[(0,b.jsx)(p.Star,{className:(0,k.cn)("h-4 w-4 mr-1",f&&"fill-current")}),"Favorites"]}),(0,b.jsxs)(o.Select,{value:h,onValueChange:i,children:[(0,b.jsx)(o.SelectTrigger,{className:"w-[140px]",children:(0,b.jsx)(o.SelectValue,{})}),(0,b.jsxs)(o.SelectContent,{children:[(0,b.jsx)(o.SelectItem,{value:"created_at-desc",children:"Newest"}),(0,b.jsx)(o.SelectItem,{value:"created_at-asc",children:"Oldest"}),(0,b.jsx)(o.SelectItem,{value:"file_size-desc",children:"Largest"}),(0,b.jsx)(o.SelectItem,{value:"file_size-asc",children:"Smallest"}),(0,b.jsx)(o.SelectItem,{value:"filename-asc",children:"Name A-Z"}),(0,b.jsx)(o.SelectItem,{value:"filename-desc",children:"Name Z-A"})]})]}),(0,b.jsxs)("div",{className:"flex rounded-md border border-border",children:[(0,b.jsx)(j.Button,{variant:"ghost",size:"sm",className:(0,k.cn)("rounded-none","grid"===l&&"bg-muted"),onClick:()=>m("grid"),children:(0,b.jsx)(q,{className:"h-4 w-4"})}),(0,b.jsx)(j.Button,{variant:"ghost",size:"sm",className:(0,k.cn)("rounded-none","list"===l&&"bg-muted"),onClick:()=>m("list"),children:(0,b.jsx)(r,{className:"h-4 w-4"})})]}),(0,b.jsxs)(j.Button,{variant:y?"default":"outline",size:"sm",onClick:z,children:[(0,b.jsx)(t.CheckSquare,{className:"h-4 w-4 mr-1"}),"Select"]})]})}var w=a.i(81560),x=a.i(49625),x=x,y=a.i(16686),z=a.i(64791),A=a.i(4720),B=a.i(86304),C=a.i(15055);let D={image:x.default,audio:y.Music,video:z.Video,document:A.FileText};function E({asset:a,viewMode:c,selectionMode:d,selected:e,onSelect:f,onFavorite:g,onDelete:h,onClick:i}){let l=D[a.file_type],m=()=>"image"===a.file_type&&a.signed_url?(0,b.jsx)("img",{src:a.signed_url,alt:a.filename,className:"h-full w-full object-cover",loading:"lazy",decoding:"async"}):(0,b.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-muted",children:(0,b.jsx)(l,{className:"h-10 w-10 text-muted-foreground"})});return"list"===c?(0,b.jsxs)("div",{className:(0,k.cn)("group flex items-center gap-4 rounded-lg bg-card border border-border p-3 cursor-pointer transition-colors duration-200 hover:bg-card-hover",e&&"bg-accent-blue/5 ring-2 ring-accent-blue"),onClick:()=>d?f(a.id):i(a),children:[(0,b.jsx)("div",{className:(0,k.cn)("flex-shrink-0 transition-opacity",d?"opacity-100":"opacity-0 group-hover:opacity-100"),onClick:a=>a.stopPropagation(),children:(0,b.jsx)(C.Checkbox,{checked:e,onCheckedChange:()=>f(a.id)})}),(0,b.jsx)("div",{className:"h-12 w-12 flex-shrink-0 overflow-hidden rounded-md",children:m()}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-medium truncate",children:a.filename}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,b.jsx)("span",{children:(0,k.formatFileSize)(a.file_size)}),(0,b.jsx)("span",{children:(0,k.formatDate)(a.created_at)})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-1",children:a.tags.slice(0,2).map(a=>(0,b.jsx)(B.Badge,{variant:"secondary",className:`text-xs ${(0,k.getTagColor)(a)}`,children:(0,k.formatTagLabel)(a)},a))}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(j.Button,{size:"sm",variant:"ghost",onClick:b=>{b.stopPropagation(),g(a.id)},children:(0,b.jsx)(p.Star,{className:(0,k.cn)("h-4 w-4",a.is_favorite&&"fill-yellow-400 text-yellow-400")})}),(0,b.jsx)(j.Button,{size:"sm",variant:"ghost",className:"text-destructive hover:text-destructive",onClick:b=>{b.stopPropagation(),h(a.id)},children:(0,b.jsx)(w.Trash2,{className:"h-4 w-4"})})]})]}):(0,b.jsxs)("div",{className:(0,k.cn)("group relative overflow-hidden rounded-lg bg-card border border-border cursor-pointer transition-colors duration-200 hover:bg-card-hover",e&&"ring-2 ring-accent-blue"),onClick:()=>d?f(a.id):i(a),children:[(0,b.jsx)("div",{className:(0,k.cn)("absolute top-2 left-2 z-10 transition-opacity",d?"opacity-100":"opacity-0 group-hover:opacity-100"),onClick:a=>a.stopPropagation(),children:(0,b.jsx)(C.Checkbox,{checked:e,onCheckedChange:()=>f(a.id),className:"bg-background/80 border-foreground/30"})}),(0,b.jsx)("div",{className:"aspect-square overflow-hidden",children:m()}),(0,b.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/40 transition-colors pointer-events-none",children:(0,b.jsxs)("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-auto",children:[(0,b.jsx)(j.Button,{size:"sm",variant:"secondary",className:"h-7 w-7 p-0",onClick:b=>{b.stopPropagation(),g(a.id)},children:(0,b.jsx)(p.Star,{className:(0,k.cn)("h-3.5 w-3.5",a.is_favorite&&"fill-yellow-400 text-yellow-400")})}),(0,b.jsx)(j.Button,{size:"sm",variant:"secondary",className:"h-7 w-7 p-0",onClick:b=>{b.stopPropagation(),h(a.id)},children:(0,b.jsx)(w.Trash2,{className:"h-3.5 w-3.5"})})]})}),(0,b.jsxs)("div",{className:"p-2",children:[(0,b.jsx)("p",{className:"text-xs font-medium truncate",children:a.filename}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,k.formatFileSize)(a.file_size)}),a.tags.length>0&&(0,b.jsxs)("div",{className:"flex gap-1 mt-1 flex-wrap",children:[a.tags.slice(0,2).map(a=>(0,b.jsx)(B.Badge,{variant:"secondary",className:`text-[10px] px-1 py-0 ${(0,k.getTagColor)(a)}`,children:(0,k.formatTagLabel)(a)},a)),a.tags.length>2&&(0,b.jsxs)("span",{className:"text-[10px] text-muted-foreground",children:["+",a.tags.length-2]})]})]})]})}function F({assets:a,total:c,viewMode:e,selectionMode:f,selectedIds:g,onSelect:h,onLoadMore:i,onFavorite:k,onDelete:l,onClick:m,loading:n}){return 0===a.length?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center rounded-lg border border-dashed py-16",children:[(0,b.jsx)(d.Upload,{className:"h-10 w-10 text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No assets yet"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Upload files to get started"})]}):(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Showing ",a.length," of ",c," assets",g.size>0&&(0,b.jsxs)("span",{className:"text-accent-blue font-medium",children:[" ","(",g.size," selected)"]})]}),"grid"===e?(0,b.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3",children:a.map(a=>(0,b.jsx)(E,{asset:a,viewMode:"grid",selectionMode:f,selected:g.has(a.id),onSelect:h,onFavorite:k,onDelete:l,onClick:m},a.id))}):(0,b.jsx)("div",{className:"space-y-2",children:a.map(a=>(0,b.jsx)(E,{asset:a,viewMode:"list",selectionMode:f,selected:g.has(a.id),onSelect:h,onFavorite:k,onDelete:l,onClick:m},a.id))}),a.length<c&&(0,b.jsx)("div",{className:"flex justify-center pt-4",children:(0,b.jsx)(j.Button,{variant:"outline",onClick:i,disabled:n,children:n?"Loading...":"Load More"})})]})}var G=a.i(14574),H=a.i(5084),I=a.i(84505),J=a.i(15618),K=a.i(5050);let L=(0,K.createServerReference)("602e1c845f8630f5f412531edc4cf883cf93a23a97",K.callServer,void 0,K.findSourceMapURL,"updateTagsAction");function M({asset:a,open:d,onOpenChange:f,onFavorite:g,onDelete:h,aiModels:i}){let[m,o]=(0,c.useState)(""),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)(!1);if(a&&!s&&JSON.stringify(q)!==JSON.stringify(a.tags)&&r(a.tags),!a)return null;let u=a.ai_model_id&&i?i.find(b=>b.id===a.ai_model_id)?.name:void 0,v=async()=>{if(!m.trim())return;let b=[...q,m.trim().toLowerCase()];r(b),t(!0),o("");let c=await L(a.id,b);c.success||l.toast.error(c.error),t(!1)},x=async b=>{let c=q.filter(a=>a!==b);r(c),t(!0);let d=await L(a.id,c);d.success||l.toast.error(d.error),t(!1)};return(0,b.jsx)(G.Dialog,{open:d,onOpenChange:a=>{f(a),t(!1)},children:(0,b.jsxs)(G.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsx)(G.DialogHeader,{children:(0,b.jsx)(G.DialogTitle,{className:"truncate",children:a.filename})}),(()=>{switch(a.file_type){case"image":return(0,b.jsx)("img",{src:a.signed_url,alt:a.filename,className:"max-h-[400px] w-full object-contain rounded-md bg-muted"});case"audio":return(0,b.jsx)("div",{className:"flex items-center justify-center p-8 bg-muted rounded-md",children:(0,b.jsx)("audio",{controls:!0,src:a.signed_url,className:"w-full"})});case"video":return(0,b.jsx)("video",{controls:!0,src:a.signed_url,className:"max-h-[400px] w-full rounded-md bg-muted"});case"document":return(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 bg-muted rounded-md",children:[(0,b.jsx)(A.FileText,{className:"h-16 w-16 text-muted-foreground mb-2"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.filename})]})}})(),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(j.Button,{variant:"outline",size:"sm",onClick:()=>{let b=document.createElement("a");b.href=a.signed_url,b.download=a.filename,b.click()},children:[(0,b.jsx)(I.Download,{className:"h-4 w-4 mr-1"}),"Download"]}),(0,b.jsxs)(j.Button,{variant:"outline",size:"sm",onClick:()=>g(a.id),children:[(0,b.jsx)(p.Star,{className:(0,k.cn)("h-4 w-4 mr-1",a.is_favorite&&"fill-yellow-400 text-yellow-400")}),a.is_favorite?"Unfavorite":"Favorite"]}),(0,b.jsxs)(j.Button,{variant:"outline",size:"sm",className:"text-destructive hover:text-destructive",onClick:()=>{h(a.id),f(!1)},children:[(0,b.jsx)(w.Trash2,{className:"h-4 w-4 mr-1"}),"Delete"]})]}),(0,b.jsx)(H.Separator,{}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Type:"})," ",a.file_type]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"MIME:"})," ",a.mime_type]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Size:"})," ",(0,k.formatFileSize)(a.file_size)]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Created:"})," ",(0,k.formatDate)(a.created_at)]}),u&&(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Model:"})," ",(0,b.jsx)(B.Badge,{variant:"secondary",className:"text-xs",children:u})]})]}),(0,b.jsx)(H.Separator,{}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"Tags"}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[q.map(a=>(0,b.jsxs)(B.Badge,{variant:"secondary",className:`gap-1 ${(0,k.getTagColor)(a)}`,children:[(0,k.formatTagLabel)(a),(0,b.jsx)("button",{onClick:()=>x(a),children:(0,b.jsx)(e.X,{className:"h-3 w-3"})})]},a)),(0,b.jsxs)("div",{className:"flex gap-1",children:[(0,b.jsx)(n.Input,{placeholder:"Add tag...",value:m,onChange:a=>o(a.target.value),onKeyDown:a=>"Enter"===a.key&&v(),className:"h-7 w-32 text-xs"}),(0,b.jsx)(j.Button,{size:"sm",variant:"ghost",className:"h-7",onClick:v,children:(0,b.jsx)(J.Plus,{className:"h-3 w-3"})})]})]})]})]})})}var N=a.i(86192);let O=(0,f.default)("folder-input",[["path",{d:"M2 9V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-1",key:"fm4g5t"}],["path",{d:"M2 13h10",key:"pgb2dq"}],["path",{d:"m9 16 3-3-3-3",key:"6m91ic"}]]);function P({selectedCount:a,totalCount:d,aiModels:f,onSelectAll:g,onClearSelection:h,onBulkDownload:k,onBulkDelete:l,onBulkAssignModel:m,downloading:n,deleting:p,assigning:q}){let[r,s]=(0,c.useState)(0);if(0===a)return null;let t=n||p||q;return(0,b.jsxs)("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 z-50 flex items-center gap-3 rounded-lg border bg-background/95 backdrop-blur px-4 py-3 shadow-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium whitespace-nowrap",children:[(0,b.jsxs)("span",{children:[a," selected"]}),a<d&&(0,b.jsxs)(j.Button,{variant:"link",size:"sm",className:"h-auto p-0 text-xs",onClick:g,children:["Select all ",d]})]}),(0,b.jsx)("div",{className:"h-6 w-px bg-border"}),(0,b.jsxs)(j.Button,{variant:"outline",size:"sm",onClick:k,disabled:t,children:[n?(0,b.jsx)(i.Loader2,{className:"h-4 w-4 mr-1 animate-spin"}):(0,b.jsx)(I.Download,{className:"h-4 w-4 mr-1"}),"Download"]}),f.length>0&&(0,b.jsxs)(o.Select,{onValueChange:a=>{m("__unassign__"===a?null:a),s(a=>a+1)},disabled:t,children:[(0,b.jsxs)(o.SelectTrigger,{className:"w-[180px] h-8",children:[q?(0,b.jsx)(i.Loader2,{className:"h-4 w-4 animate-spin"}):(0,b.jsx)(O,{className:"h-4 w-4"}),(0,b.jsx)(o.SelectValue,{placeholder:"Assign to Model"})]}),(0,b.jsxs)(o.SelectContent,{position:"popper",side:"top",align:"start",children:[(0,b.jsx)(o.SelectItem,{value:"__unassign__",children:"Remove from Model"}),f.map(a=>(0,b.jsx)(o.SelectItem,{value:a.id,children:a.name},a.id))]})]},r),(0,b.jsxs)(N.AlertDialog,{children:[(0,b.jsx)(N.AlertDialogTrigger,{asChild:!0,children:(0,b.jsxs)(j.Button,{variant:"outline",size:"sm",className:"text-destructive hover:text-destructive",disabled:t,children:[p?(0,b.jsx)(i.Loader2,{className:"h-4 w-4 mr-1 animate-spin"}):(0,b.jsx)(w.Trash2,{className:"h-4 w-4 mr-1"}),"Delete"]})}),(0,b.jsxs)(N.AlertDialogContent,{children:[(0,b.jsxs)(N.AlertDialogHeader,{children:[(0,b.jsxs)(N.AlertDialogTitle,{children:["Delete ",a," asset",a>1?"s":"","?"]}),(0,b.jsxs)(N.AlertDialogDescription,{children:["This will permanently delete ",a," selected asset",a>1?"s":""," from storage. This action cannot be undone."]})]}),(0,b.jsxs)(N.AlertDialogFooter,{children:[(0,b.jsx)(N.AlertDialogCancel,{children:"Cancel"}),(0,b.jsxs)(N.AlertDialogAction,{onClick:l,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:["Delete ",a," asset",a>1?"s":""]})]})]})]}),(0,b.jsx)(j.Button,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",onClick:h,children:(0,b.jsx)(e.X,{className:"h-4 w-4"})})]})}var Q=a.i(50558);let R=(0,K.createServerReference)("400f9cd13317e2cd5ffcd01c986e487acfed902af0",K.callServer,void 0,K.findSourceMapURL,"toggleFavoriteAction"),S=(0,K.createServerReference)("401a61d277e1e8de37b642ff39d23bca1ab85e7ae1",K.callServer,void 0,K.findSourceMapURL,"deleteAssetAction"),T=(0,K.createServerReference)("40b258e326f20bb2dbc968a496bcf015cdae5e7353",K.callServer,void 0,K.findSourceMapURL,"bulkDeleteAssetsAction"),U=(0,K.createServerReference)("607eee48e074499ac9911884e2acd0c8a36b9c8806",K.callServer,void 0,K.findSourceMapURL,"bulkAssignModelAction"),V=(0,K.createServerReference)("4066e82f12aa11473234b4a7222a4f5877a074ce8b",K.callServer,void 0,K.findSourceMapURL,"getSignedUrlsAction");function W({initialAssets:a,initialTotal:d,userTags:e,aiModels:f}){let[g,h]=(0,c.useState)(a),[i,j]=(0,c.useState)(d),[k,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(),[s,t]=(0,c.useState)(!1),[u,w]=(0,c.useState)("created_at-desc"),[x,y]=(0,c.useState)("grid"),[z,A]=(0,c.useState)(),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(!1),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(new Set),[K,L]=(0,c.useState)(!1),[N,O]=(0,c.useState)(!1),[W,X]=(0,c.useState)(!1),Y=(0,c.useRef)(void 0),Z=(0,c.useCallback)((a=0)=>{let[b,c]=u.split("-");return{file_type:q,is_favorite:!!s||void 0,search:o||void 0,ai_model_id:"__unassigned__"===z?null:z||void 0,sort_by:b,sort_order:c,limit:24,offset:a}},[q,s,o,u,z]),$=(0,c.useCallback)(async(a=!1)=>{n(!0);let b=a?g.length:0,c=await (0,Q.getAssetsAction)(Z(b));c.error?l.toast.error(c.error):a?h(a=>[...a,...c.assets]):h(c.assets),j(c.total),n(!1)},[Z,g.length]);(0,c.useEffect)(()=>{J(new Set),$()},[q,s,u,z]);let _=async a=>{let b=await R(a);b.success?(h(b=>b.map(b=>b.id===a?{...b,is_favorite:!b.is_favorite}:b)),B?.id===a&&C(a=>a?{...a,is_favorite:!a.is_favorite}:a)):l.toast.error(b.error)},aa=async a=>{let b=await S(a);b.success?(h(b=>b.filter(b=>b.id!==a)),j(a=>a-1),J(b=>{let c=new Set(b);return c.delete(a),c}),l.toast.success("Asset deleted")):l.toast.error(b.error)},ab=async()=>{L(!0);let a=Array.from(I),b=await V(a);if(b.error)l.toast.error(b.error);else{for(let a of b.urls){let b=document.createElement("a");b.href=a.url,b.download=a.filename,document.body.appendChild(b),b.click(),document.body.removeChild(b),await new Promise(a=>setTimeout(a,300))}l.toast.success(`Downloading ${b.urls.length} files`)}L(!1)},ac=async()=>{O(!0);let a=Array.from(I),b=await T(a);b.success?(h(a=>a.filter(a=>!I.has(a.id))),j(a=>a-b.deletedCount),J(new Set),l.toast.success(`Deleted ${b.deletedCount} assets`)):l.toast.error(b.error),O(!1)},ad=async a=>{X(!0);let b=Array.from(I),c=await U(b,a);if(c.success){let c=a?f.find(b=>b.id===a)?.name||"model":"no model";l.toast.success(`Assigned ${b.length} assets to ${c}`),J(new Set),$()}else l.toast.error(c.error);X(!1)};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(m,{onUploadComplete:()=>$()}),(0,b.jsx)(v,{search:o,onSearchChange:a=>{p(a),clearTimeout(Y.current),Y.current=setTimeout(()=>{J(new Set),$()},300)},fileType:q,onFileTypeChange:r,favoritesOnly:s,onFavoritesToggle:()=>t(!s),sortBy:u,onSortChange:w,viewMode:x,onViewModeChange:y,aiModels:f,selectedModelId:z,onModelChange:a=>{A(a)},selectionMode:G,onSelectionModeToggle:()=>{G&&J(new Set),H(!G)}}),(0,b.jsx)(F,{assets:g,total:i,viewMode:x,selectionMode:G,selectedIds:I,onSelect:a=>{J(b=>{let c=new Set(b);return c.has(a)?c.delete(a):c.add(a),c}),G||H(!0)},onLoadMore:()=>$(!0),onFavorite:_,onDelete:aa,onClick:a=>{C(a),E(!0)},loading:k}),(0,b.jsx)(M,{asset:B,open:D,onOpenChange:E,onFavorite:_,onDelete:aa,aiModels:f}),(0,b.jsx)(P,{selectedCount:I.size,totalCount:i,aiModels:f,onSelectAll:()=>{J(new Set(g.map(a=>a.id)))},onClearSelection:()=>{J(new Set),H(!1)},onBulkDownload:ab,onBulkDelete:ac,onBulkAssignModel:ad,downloading:K,deleting:N,assigning:W})]})}a.s(["AssetLibrary",()=>W],93509)}];

//# sourceMappingURL=src_components_assets_asset-library_tsx_7b58439d._.js.map