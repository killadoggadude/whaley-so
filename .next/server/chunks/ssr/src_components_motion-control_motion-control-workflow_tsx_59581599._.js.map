{"version":3,"sources":["../../../../src/components/motion-control/motion-control-workflow.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, useRef, useCallback } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { Progress } from \"@/components/ui/progress\";\nimport {\n  Loader2,\n  AlertCircle,\n  CheckCircle2,\n  RefreshCw,\n  Upload,\n  Download,\n  Save,\n  Check,\n  Link2,\n  ImageIcon,\n  Play,\n  Clapperboard,\n  ArrowRight,\n  Eye,\n} from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { toast } from \"sonner\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport type { AiModelWithImages } from \"@/types\";\n\ninterface MotionControlWorkflowProps {\n  aiModels: AiModelWithImages[];\n}\n\n/** Check if a URL is a social media page URL (not a direct video file) */\nfunction isSocialUrl(url: string): boolean {\n  return (\n    url.includes(\"instagram.com\") ||\n    url.includes(\"instagr.am\") ||\n    url.includes(\"tiktok.com\")\n  );\n}\n\nconst POLL_INTERVAL_MS = 5000;\nconst MAX_POLL_ATTEMPTS = 200;\n\ntype PipelineStep =\n  | \"input\"          // Step 1: Provide video + select AI model\n  | \"extracting\"     // Extracting first frame\n  | \"extracted\"      // Frame extracted, ready to recreate\n  | \"recreating\"     // Recreating image with AI model identity\n  | \"recreated\"      // Image recreated, ready to generate\n  | \"generating\"     // Generating motion control video\n  | \"completed\"      // Video generated\n  | \"failed\";        // Any step failed\n\nexport function MotionControlWorkflow({\n  aiModels,\n}: MotionControlWorkflowProps) {\n  // Step 1: Video input\n  const [videoSource, setVideoSource] = useState<\"url\" | \"upload\">(\"url\");\n  const [videoUrl, setVideoUrl] = useState(\"\");\n  const [uploadedVideoUrl, setUploadedVideoUrl] = useState<string | null>(null);\n  const [videoUploading, setVideoUploading] = useState(false);\n  const videoInputRef = useRef<HTMLInputElement>(null);\n\n  // Step 1: AI Model selection\n  const [selectedModelId, setSelectedModelId] = useState<string>(\n    aiModels.length === 1 ? aiModels[0].id : \"\"\n  );\n\n  // Step 2: Extracted frame\n  const [frameUrl, setFrameUrl] = useState<string | null>(null);\n  // The resolved direct video URL (from Instagram/TikTok resolution or Supabase upload)\n  const [resolvedVideoUrl, setResolvedVideoUrl] = useState<string | null>(null);\n\n  // Step 3: Recreated image\n  const [recreatedImageUrl, setRecreatedImageUrl] = useState<string | null>(null);\n  const [recreatePrompt, setRecreatePrompt] = useState(\"\");\n\n  // Step 4: Motion control settings\n  const [motionPrompt, setMotionPrompt] = useState(\"\");\n  const [characterOrientation, setCharacterOrientation] = useState<\"image\" | \"video\">(\"image\");\n\n  // Pipeline state\n  const [step, setStep] = useState<PipelineStep>(\"input\");\n  const [error, setError] = useState<string | null>(null);\n  const [pollCount, setPollCount] = useState(0);\n  const [resultVideoUrl, setResultVideoUrl] = useState<string | null>(null);\n  const [savedAssetId, setSavedAssetId] = useState<string | null>(null);\n  const [saving, setSaving] = useState(false);\n  const pollingRef = useRef(false);\n\n  const selectedModel = aiModels.find((m) => m.id === selectedModelId) || null;\n  const modelImages = selectedModel?.reference_images || [];\n\n  // The input video URL — either from URL input or upload\n  const inputVideoUrl =\n    videoSource === \"url\" ? videoUrl.trim() : uploadedVideoUrl;\n  const hasVideoInput = !!inputVideoUrl;\n  // For motion control step, use the resolved/stable video URL (direct .mp4)\n  const effectiveVideoUrl = resolvedVideoUrl || inputVideoUrl;\n\n  // Cleanup polling on unmount\n  useEffect(() => {\n    return () => {\n      pollingRef.current = false;\n    };\n  }, []);\n\n  // ── Video upload handler ──────────────────────────────────────────\n\n  const handleVideoUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    if (!file.type.startsWith(\"video/\")) {\n      toast.error(\"Please select a video file\");\n      return;\n    }\n    if (file.size > 100 * 1024 * 1024) {\n      toast.error(\"File exceeds 100MB size limit\");\n      return;\n    }\n\n    setVideoUploading(true);\n    try {\n      const supabase = createClient();\n      const {\n        data: { user },\n      } = await supabase.auth.getUser();\n      if (!user) {\n        toast.error(\"Not authenticated\");\n        return;\n      }\n\n      const uuid = crypto.randomUUID();\n      const safeName = file.name.replace(/[^a-zA-Z0-9._-]/g, \"_\");\n      const filePath = `${user.id}/video/${uuid}_${safeName}`;\n\n      const { error: uploadError } = await supabase.storage\n        .from(\"assets\")\n        .upload(filePath, file, { contentType: file.type, upsert: false });\n\n      if (uploadError) {\n        toast.error(`Upload failed: ${uploadError.message}`);\n        return;\n      }\n\n      const { data: urlData } = await supabase.storage\n        .from(\"assets\")\n        .createSignedUrl(filePath, 3600);\n\n      if (urlData?.signedUrl) {\n        setUploadedVideoUrl(urlData.signedUrl);\n        toast.success(\"Video uploaded!\");\n      }\n    } catch {\n      toast.error(\"Failed to upload video\");\n    } finally {\n      setVideoUploading(false);\n      if (videoInputRef.current) videoInputRef.current.value = \"\";\n    }\n  };\n\n  // ── Step 2: Extract first frame ───────────────────────────────────\n\n  const handleExtractFrame = async () => {\n    if (!inputVideoUrl) {\n      toast.error(\"Please provide a video first\");\n      return;\n    }\n    if (!selectedModelId) {\n      toast.error(\"Please select an AI model\");\n      return;\n    }\n\n    setStep(\"extracting\");\n    setError(null);\n    setFrameUrl(null);\n    setResolvedVideoUrl(null);\n    setRecreatedImageUrl(null);\n    setResultVideoUrl(null);\n    setSavedAssetId(null);\n\n    try {\n      const res = await fetch(\"/api/motion-control/extract-frame\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ videoUrl: inputVideoUrl }),\n      });\n\n      const data = await res.json();\n\n      if (!res.ok) {\n        setStep(\"failed\");\n        setError(data.error || \"Failed to extract frame\");\n        return;\n      }\n\n      setFrameUrl(data.frameUrl);\n      // Store the resolved video URL (direct .mp4 from Supabase or CDN)\n      // This is needed because Instagram/TikTok page URLs don't work as direct video inputs\n      if (data.resolvedVideoUrl) {\n        setResolvedVideoUrl(data.resolvedVideoUrl);\n      }\n      setStep(\"extracted\");\n      toast.success(\"First frame extracted!\");\n    } catch {\n      setStep(\"failed\");\n      setError(\"Failed to extract frame from video\");\n    }\n  };\n\n  // ── Step 3: Recreate image with AI model identity ─────────────────\n\n  const pollRecreateImage = useCallback(async (taskId: string) => {\n    pollingRef.current = true;\n    let attempts = 0;\n    let consecutiveErrors = 0;\n\n    while (pollingRef.current && attempts < MAX_POLL_ATTEMPTS) {\n      attempts++;\n      setPollCount(attempts);\n\n      try {\n        const res = await fetch(\n          `/api/motion-control/recreate-status?taskId=${encodeURIComponent(taskId)}`\n        );\n        const data = await res.json();\n\n        if (data.status === \"completed\" && data.imageUrl) {\n          pollingRef.current = false;\n          setRecreatedImageUrl(data.imageUrl);\n          setStep(\"recreated\");\n          toast.success(\"Image recreated with your AI model!\");\n          return;\n        }\n\n        if (data.status === \"failed\") {\n          pollingRef.current = false;\n          setStep(\"failed\");\n          setError(data.error || \"Image recreation failed\");\n          return;\n        }\n\n        consecutiveErrors = 0;\n        await new Promise((r) => setTimeout(r, POLL_INTERVAL_MS));\n      } catch {\n        consecutiveErrors++;\n        if (consecutiveErrors >= 3) {\n          pollingRef.current = false;\n          setStep(\"failed\");\n          setError(\"Network error after multiple retries\");\n          return;\n        }\n        await new Promise((r) => setTimeout(r, POLL_INTERVAL_MS));\n      }\n    }\n\n    if (pollingRef.current) {\n      pollingRef.current = false;\n      setStep(\"failed\");\n      setError(`Timed out after ${attempts} polls`);\n    }\n  }, []);\n\n  const handleRecreateImage = async () => {\n    if (!frameUrl || !selectedModel || modelImages.length === 0) {\n      toast.error(\"Missing frame or model reference images\");\n      return;\n    }\n\n    setStep(\"recreating\");\n    setError(null);\n    setPollCount(0);\n    setRecreatedImageUrl(null);\n    setResultVideoUrl(null);\n\n    try {\n      const referenceImageUrls = modelImages.map((img) => img.signed_url);\n\n      const res = await fetch(\"/api/motion-control/recreate-image\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          referenceImageUrls,\n          frameUrl,\n          prompt: recreatePrompt.trim() || undefined,\n          aspectRatio: \"9:16\",\n        }),\n      });\n\n      const data = await res.json();\n\n      if (!res.ok) {\n        setStep(\"failed\");\n        setError(data.error || \"Failed to submit image recreation\");\n        return;\n      }\n\n      toast.info(\"Recreating image with AI model identity...\");\n      pollRecreateImage(data.taskId);\n    } catch {\n      setStep(\"failed\");\n      setError(\"Failed to submit image recreation\");\n    }\n  };\n\n  // ── Step 4: Generate motion control video ─────────────────────────\n\n  const pollMotionControl = useCallback(async (taskId: string) => {\n    pollingRef.current = true;\n    let attempts = 0;\n    let consecutiveErrors = 0;\n\n    while (pollingRef.current && attempts < MAX_POLL_ATTEMPTS) {\n      attempts++;\n      setPollCount(attempts);\n\n      try {\n        // Reuse the generic WaveSpeed polling route\n        const res = await fetch(\n          `/api/talking-head/status?taskId=${encodeURIComponent(taskId)}`\n        );\n        const data = await res.json();\n\n        if (data.status === \"completed\" && data.videoUrl) {\n          pollingRef.current = false;\n          setResultVideoUrl(data.videoUrl);\n          setStep(\"completed\");\n          toast.success(\"Motion control video generated!\");\n          return;\n        }\n\n        if (data.status === \"failed\") {\n          pollingRef.current = false;\n          setStep(\"failed\");\n          setError(data.error || \"Video generation failed\");\n          return;\n        }\n\n        consecutiveErrors = 0;\n        await new Promise((r) => setTimeout(r, POLL_INTERVAL_MS));\n      } catch {\n        consecutiveErrors++;\n        if (consecutiveErrors >= 3) {\n          pollingRef.current = false;\n          setStep(\"failed\");\n          setError(\"Network error after multiple retries\");\n          return;\n        }\n        await new Promise((r) => setTimeout(r, POLL_INTERVAL_MS));\n      }\n    }\n\n    if (pollingRef.current) {\n      pollingRef.current = false;\n      setStep(\"failed\");\n      setError(`Timed out after ${attempts} polls`);\n    }\n  }, []);\n\n  const handleGenerateVideo = async () => {\n    if (!recreatedImageUrl || !effectiveVideoUrl) {\n      toast.error(\"Missing recreated image or reference video\");\n      return;\n    }\n\n    setStep(\"generating\");\n    setError(null);\n    setPollCount(0);\n    setResultVideoUrl(null);\n    setSavedAssetId(null);\n\n    try {\n      const res = await fetch(\"/api/motion-control/submit\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          imageUrl: recreatedImageUrl,\n          videoUrl: effectiveVideoUrl,\n          prompt: motionPrompt.trim() || undefined,\n          characterOrientation,\n        }),\n      });\n\n      const data = await res.json();\n\n      if (!res.ok) {\n        setStep(\"failed\");\n        setError(data.error || \"Failed to submit motion control generation\");\n        return;\n      }\n\n      toast.info(\"Generating motion control video...\");\n      pollMotionControl(data.taskId);\n    } catch {\n      setStep(\"failed\");\n      setError(\"Failed to submit motion control generation\");\n    }\n  };\n\n  // ── Save to library ───────────────────────────────────────────────\n\n  const handleSave = async () => {\n    if (!resultVideoUrl) return;\n    setSaving(true);\n    try {\n      const res = await fetch(\"/api/motion-control/save\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ videoUrl: resultVideoUrl }),\n      });\n      const data = await res.json();\n      if (res.ok) {\n        setSavedAssetId(data.assetId);\n        toast.success(\"Video saved to library!\");\n      } else {\n        toast.error(data.error || \"Failed to save\");\n      }\n    } catch {\n      toast.error(\"Failed to save video\");\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  // ── Reset ─────────────────────────────────────────────────────────\n\n  const handleReset = () => {\n    pollingRef.current = false;\n    setStep(\"input\");\n    setError(null);\n    setPollCount(0);\n    setFrameUrl(null);\n    setResolvedVideoUrl(null);\n    setRecreatedImageUrl(null);\n    setResultVideoUrl(null);\n    setSavedAssetId(null);\n    setVideoUrl(\"\");\n    setUploadedVideoUrl(null);\n    setRecreatePrompt(\"\");\n    setMotionPrompt(\"\");\n  };\n\n  const handleRetry = () => {\n    pollingRef.current = false;\n    // Go back to the last successful step\n    if (recreatedImageUrl) {\n      setStep(\"recreated\");\n    } else if (frameUrl) {\n      setStep(\"extracted\");\n    } else {\n      setStep(\"input\");\n    }\n    setError(null);\n    setPollCount(0);\n  };\n\n  // ── Derived state ─────────────────────────────────────────────────\n\n  const isProcessing =\n    step === \"extracting\" ||\n    step === \"recreating\" ||\n    step === \"generating\";\n\n  const elapsedSeconds = pollCount * (POLL_INTERVAL_MS / 1000);\n  const progressPercent = Math.min((pollCount / MAX_POLL_ATTEMPTS) * 100, 95);\n\n  const stepNumber = (s: PipelineStep): number => {\n    switch (s) {\n      case \"input\":\n        return 1;\n      case \"extracting\":\n      case \"extracted\":\n        return 2;\n      case \"recreating\":\n      case \"recreated\":\n        return 3;\n      case \"generating\":\n      case \"completed\":\n        return 4;\n      case \"failed\":\n        return 0;\n    }\n  };\n\n  const currentStep = stepNumber(step);\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Pipeline Progress Indicator */}\n      <div className=\"flex items-center gap-2 px-1\">\n        {[\n          { num: 1, label: \"Video Input\" },\n          { num: 2, label: \"Extract Frame\" },\n          { num: 3, label: \"Recreate Image\" },\n          { num: 4, label: \"Generate Video\" },\n        ].map(({ num, label }, i) => (\n          <div key={num} className=\"flex items-center gap-2 flex-1\">\n            <div className=\"flex items-center gap-2 min-w-0\">\n              <div\n                className={cn(\n                  \"flex-shrink-0 w-7 h-7 rounded-full flex items-center justify-center text-xs font-semibold transition-colors\",\n                  currentStep > num\n                    ? \"bg-green-500 text-white\"\n                    : currentStep === num\n                      ? \"bg-primary text-primary-foreground\"\n                      : \"bg-muted text-muted-foreground\"\n                )}\n              >\n                {currentStep > num ? (\n                  <Check className=\"h-3.5 w-3.5\" />\n                ) : (\n                  num\n                )}\n              </div>\n              <span\n                className={cn(\n                  \"text-xs font-medium truncate\",\n                  currentStep >= num\n                    ? \"text-foreground\"\n                    : \"text-muted-foreground\"\n                )}\n              >\n                {label}\n              </span>\n            </div>\n            {i < 3 && (\n              <ArrowRight\n                className={cn(\n                  \"h-3.5 w-3.5 flex-shrink-0\",\n                  currentStep > num\n                    ? \"text-green-500\"\n                    : \"text-muted-foreground/40\"\n                )}\n              />\n            )}\n          </div>\n        ))}\n      </div>\n\n      {/* ── Step 1: Video Input + Model Selection ────────────────── */}\n      <div className=\"rounded-lg border border-border bg-card p-5 space-y-4\">\n        <div className=\"flex items-start gap-3\">\n          <div\n            className={cn(\n              \"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold\",\n              currentStep > 1\n                ? \"bg-green-500 text-white\"\n                : \"bg-primary text-primary-foreground\"\n            )}\n          >\n            {currentStep > 1 ? <Check className=\"h-4 w-4\" /> : \"1\"}\n          </div>\n          <div className=\"flex-1 min-w-0\">\n            <h3 className=\"text-base font-semibold\">\n              Reference Video & AI Model\n            </h3>\n            <p className=\"text-sm text-muted-foreground mt-0.5\">\n              Provide a reference video (the motions to copy) and select the AI\n              model whose identity will be used.\n            </p>\n          </div>\n        </div>\n\n        {/* Video source toggle */}\n        <div className=\"space-y-3\">\n          <div className=\"flex gap-2\">\n            <Button\n              variant={videoSource === \"url\" ? \"default\" : \"outline\"}\n              size=\"sm\"\n              onClick={() => setVideoSource(\"url\")}\n              disabled={isProcessing}\n            >\n              <Link2 className=\"h-3.5 w-3.5 mr-1.5\" />\n              Paste URL\n            </Button>\n            <Button\n              variant={videoSource === \"upload\" ? \"default\" : \"outline\"}\n              size=\"sm\"\n              onClick={() => setVideoSource(\"upload\")}\n              disabled={isProcessing}\n            >\n              <Upload className=\"h-3.5 w-3.5 mr-1.5\" />\n              Upload Video\n            </Button>\n          </div>\n\n          {videoSource === \"url\" ? (\n            <div className=\"space-y-1.5\">\n              <Label>Video URL</Label>\n              <Input\n                value={videoUrl}\n                onChange={(e) => setVideoUrl(e.target.value)}\n                placeholder=\"https://... (direct video URL, Instagram reel, TikTok, etc.)\"\n                disabled={isProcessing}\n              />\n              <p className=\"text-xs text-muted-foreground\">\n                Paste a direct video URL. For Instagram/TikTok, you may need to\n                use a direct download link.\n              </p>\n            </div>\n          ) : (\n            <div className=\"space-y-1.5\">\n              <Label>Upload Video</Label>\n              <input\n                ref={videoInputRef}\n                type=\"file\"\n                accept=\"video/*\"\n                onChange={handleVideoUpload}\n                className=\"hidden\"\n              />\n              <div className=\"flex items-center gap-3\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => videoInputRef.current?.click()}\n                  disabled={videoUploading || isProcessing}\n                >\n                  {videoUploading ? (\n                    <Loader2 className=\"h-4 w-4 mr-1.5 animate-spin\" />\n                  ) : (\n                    <Upload className=\"h-4 w-4 mr-1.5\" />\n                  )}\n                  {videoUploading ? \"Uploading...\" : \"Choose Video\"}\n                </Button>\n                {uploadedVideoUrl && (\n                  <Badge variant=\"secondary\" className=\"gap-1\">\n                    <Check className=\"h-3 w-3\" />\n                    Video uploaded\n                  </Badge>\n                )}\n              </div>\n              <p className=\"text-xs text-muted-foreground\">\n                Max 100MB. MP4 recommended. 3-30 seconds.\n              </p>\n            </div>\n          )}\n        </div>\n\n        {/* Video preview — show resolved URL if available (direct .mp4), otherwise input URL */}\n        {(resolvedVideoUrl || (inputVideoUrl && !isSocialUrl(inputVideoUrl))) && (\n          <div className=\"space-y-2\">\n            <Label className=\"text-xs text-muted-foreground\">\n              Reference Video Preview\n            </Label>\n            <video\n              controls\n              src={resolvedVideoUrl || inputVideoUrl || \"\"}\n              className=\"w-full max-h-[250px] rounded-md bg-black\"\n              preload=\"metadata\"\n            />\n          </div>\n        )}\n\n        {/* AI Model selection */}\n        <div className=\"space-y-1.5\">\n          <Label>AI Model</Label>\n          {aiModels.length === 0 ? (\n            <Alert>\n              <AlertCircle className=\"h-4 w-4\" />\n              <AlertDescription>\n                No active AI models found. Create one in the{\" \"}\n                <a\n                  href=\"/dashboard/models\"\n                  className=\"underline font-medium\"\n                >\n                  AI Models\n                </a>{\" \"}\n                section first.\n              </AlertDescription>\n            </Alert>\n          ) : (\n            <select\n              value={selectedModelId}\n              onChange={(e) => setSelectedModelId(e.target.value)}\n              className=\"w-full h-9 rounded-md border border-input bg-background px-3 text-sm\"\n              disabled={isProcessing}\n            >\n              <option value=\"\">Select an AI model...</option>\n              {aiModels.map((m) => (\n                <option key={m.id} value={m.id}>\n                  {m.name} ({m.reference_images.length} reference images)\n                </option>\n              ))}\n            </select>\n          )}\n        </div>\n\n        {/* Model reference images preview */}\n        {selectedModel && modelImages.length > 0 && (\n          <div className=\"space-y-2\">\n            <Label className=\"text-xs text-muted-foreground\">\n              Reference Images ({modelImages.length})\n            </Label>\n            <div className=\"flex gap-2 overflow-x-auto pb-1\">\n              {modelImages.map((img) => (\n                <img\n                  key={img.id}\n                  src={img.signed_url}\n                  alt={img.filename}\n                  className=\"h-20 w-14 object-cover rounded-md border border-border flex-shrink-0\"\n                  loading=\"lazy\"\n                />\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Selected model warning if no reference images */}\n        {selectedModel && modelImages.length === 0 && (\n          <Alert variant=\"destructive\">\n            <AlertCircle className=\"h-4 w-4\" />\n            <AlertDescription>\n              This model has no reference images. Add reference images in the{\" \"}\n              <a\n                href=\"/dashboard/models\"\n                className=\"underline font-medium\"\n              >\n                AI Models\n              </a>{\" \"}\n              section.\n            </AlertDescription>\n          </Alert>\n        )}\n\n        {/* Start pipeline button */}\n        {step === \"input\" && (\n          <Button\n            onClick={handleExtractFrame}\n            className=\"w-full\"\n            size=\"lg\"\n            disabled={\n              !hasVideoInput ||\n              !selectedModelId ||\n              modelImages.length === 0\n            }\n          >\n            <Play className=\"h-4 w-4 mr-2\" />\n            Start Pipeline — Extract First Frame\n          </Button>\n        )}\n      </div>\n\n      {/* ── Step 2: Frame Extraction ─────────────────────────────── */}\n      {(currentStep >= 2 || step === \"extracting\") && (\n        <div className=\"rounded-lg border border-border bg-card p-5 space-y-4\">\n          <div className=\"flex items-start gap-3\">\n            <div\n              className={cn(\n                \"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold\",\n                currentStep > 2\n                  ? \"bg-green-500 text-white\"\n                  : currentStep === 2\n                    ? \"bg-primary text-primary-foreground\"\n                    : \"bg-muted text-muted-foreground\"\n              )}\n            >\n              {currentStep > 2 ? <Check className=\"h-4 w-4\" /> : \"2\"}\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              <h3 className=\"text-base font-semibold\">\n                Extract First Frame\n              </h3>\n              <p className=\"text-sm text-muted-foreground mt-0.5\">\n                The first frame of the reference video is extracted to use as\n                the base for identity recreation.\n              </p>\n            </div>\n          </div>\n\n          {step === \"extracting\" && (\n            <div className=\"flex items-center gap-2\">\n              <Loader2 className=\"h-4 w-4 animate-spin text-accent-blue\" />\n              <span className=\"text-sm font-medium\">\n                Extracting first frame...\n              </span>\n            </div>\n          )}\n\n          {frameUrl && (\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"h-4 w-4 text-green-500\" />\n                <span className=\"text-sm font-medium\">\n                  First frame extracted\n                </span>\n              </div>\n              <img\n                src={frameUrl}\n                alt=\"Extracted first frame\"\n                className=\"max-h-[300px] rounded-md border border-border\"\n              />\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* ── Step 3: Recreate Image ───────────────────────────────── */}\n      {(currentStep >= 3 || step === \"extracted\") && (\n        <div className=\"rounded-lg border border-border bg-card p-5 space-y-4\">\n          <div className=\"flex items-start gap-3\">\n            <div\n              className={cn(\n                \"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold\",\n                currentStep > 3\n                  ? \"bg-green-500 text-white\"\n                  : currentStep === 3\n                    ? \"bg-primary text-primary-foreground\"\n                    : \"bg-muted text-muted-foreground\"\n              )}\n            >\n              {currentStep > 3 ? <Check className=\"h-4 w-4\" /> : \"3\"}\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              <h3 className=\"text-base font-semibold\">\n                Recreate Image with AI Model\n              </h3>\n              <p className=\"text-sm text-muted-foreground mt-0.5\">\n                The extracted frame is recreated using your AI model&apos;s\n                identity via Nano Banana Pro Edit. Same pose, outfit, and\n                background — different person.\n              </p>\n            </div>\n          </div>\n\n          {/* Custom prompt override (optional) */}\n          {step === \"extracted\" && (\n            <div className=\"space-y-3\">\n              <div className=\"space-y-1.5\">\n                <Label>\n                  Recreation Prompt{\" \"}\n                  <span className=\"text-muted-foreground font-normal\">\n                    (optional override)\n                  </span>\n                </Label>\n                <Textarea\n                  value={recreatePrompt}\n                  onChange={(e) => setRecreatePrompt(e.target.value)}\n                  placeholder=\"Leave empty to use the default identity-swap prompt. Override if you need specific adjustments.\"\n                  rows={3}\n                  className=\"resize-y text-sm\"\n                />\n                <p className=\"text-xs text-muted-foreground\">\n                  Default prompt swaps the person&apos;s identity while keeping\n                  pose, outfit, background, and expression.\n                </p>\n              </div>\n\n              <Button\n                onClick={handleRecreateImage}\n                className=\"w-full\"\n                size=\"lg\"\n              >\n                <ImageIcon className=\"h-4 w-4 mr-2\" />\n                Recreate Image with {selectedModel?.name || \"AI Model\"} — Est.\n                $0.14\n              </Button>\n            </div>\n          )}\n\n          {step === \"recreating\" && (\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center gap-2\">\n                <Loader2 className=\"h-4 w-4 animate-spin text-accent-blue\" />\n                <span className=\"text-sm font-medium\">\n                  Recreating image with AI model identity...\n                </span>\n                <span className=\"text-xs text-muted-foreground ml-auto\">\n                  {Math.round(elapsedSeconds)}s elapsed\n                </span>\n              </div>\n              <Progress value={progressPercent} className=\"h-2\" />\n              <p className=\"text-xs text-muted-foreground text-center\">\n                {pollCount < 12 &&\n                  \"Processing with Nano Banana Pro Edit. Usually takes 30-60 seconds...\"}\n                {pollCount >= 12 &&\n                  pollCount < 30 &&\n                  \"Still generating. This can take up to 2 minutes...\"}\n                {pollCount >= 30 && \"Almost there. Please wait...\"}\n              </p>\n            </div>\n          )}\n\n          {recreatedImageUrl && (\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"h-4 w-4 text-green-500\" />\n                <span className=\"text-sm font-medium\">\n                  Image recreated successfully\n                </span>\n              </div>\n              <div className=\"grid grid-cols-2 gap-3\">\n                <div className=\"space-y-1\">\n                  <Label className=\"text-xs text-muted-foreground\">\n                    Original Frame\n                  </Label>\n                  <img\n                    src={frameUrl!}\n                    alt=\"Original frame\"\n                    className=\"w-full rounded-md border border-border\"\n                  />\n                </div>\n                <div className=\"space-y-1\">\n                  <Label className=\"text-xs text-muted-foreground\">\n                    Recreated with {selectedModel?.name}\n                  </Label>\n                  <img\n                    src={recreatedImageUrl}\n                    alt=\"Recreated frame\"\n                    className=\"w-full rounded-md border border-border\"\n                  />\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* ── Step 4: Generate Motion Control Video ────────────────── */}\n      {(currentStep >= 4 || step === \"recreated\") && (\n        <div className=\"rounded-lg border border-border bg-card p-5 space-y-4\">\n          <div className=\"flex items-start gap-3\">\n            <div\n              className={cn(\n                \"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold\",\n                step === \"completed\"\n                  ? \"bg-green-500 text-white\"\n                  : currentStep === 4\n                    ? \"bg-primary text-primary-foreground\"\n                    : \"bg-muted text-muted-foreground\"\n              )}\n            >\n              {step === \"completed\" ? (\n                <Check className=\"h-4 w-4\" />\n              ) : (\n                \"4\"\n              )}\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              <h3 className=\"text-base font-semibold\">\n                Generate Motion Control Video\n              </h3>\n              <p className=\"text-sm text-muted-foreground mt-0.5\">\n                The recreated image and original video are combined using Kling\n                2.6 Pro Motion Control to generate the final video.\n              </p>\n            </div>\n          </div>\n\n          {step === \"recreated\" && (\n            <div className=\"space-y-3\">\n              {/* Motion prompt (optional) */}\n              <div className=\"space-y-1.5\">\n                <Label>\n                  Refinement Prompt{\" \"}\n                  <span className=\"text-muted-foreground font-normal\">\n                    (optional)\n                  </span>\n                </Label>\n                <Textarea\n                  value={motionPrompt}\n                  onChange={(e) => setMotionPrompt(e.target.value)}\n                  placeholder=\"Optional: refine scene details (e.g., 'soft lighting, cinematic feel')\"\n                  rows={2}\n                  className=\"resize-y text-sm\"\n                />\n              </div>\n\n              {/* Character orientation */}\n              <div className=\"space-y-1.5\">\n                <Label>Character Orientation</Label>\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant={\n                      characterOrientation === \"image\"\n                        ? \"default\"\n                        : \"outline\"\n                    }\n                    size=\"sm\"\n                    onClick={() => setCharacterOrientation(\"image\")}\n                    className=\"flex-1\"\n                  >\n                    <ImageIcon className=\"h-3.5 w-3.5 mr-1.5\" />\n                    From Image (Recommended)\n                  </Button>\n                  <Button\n                    variant={\n                      characterOrientation === \"video\"\n                        ? \"default\"\n                        : \"outline\"\n                    }\n                    size=\"sm\"\n                    onClick={() => setCharacterOrientation(\"video\")}\n                    className=\"flex-1\"\n                  >\n                    <Play className=\"h-3.5 w-3.5 mr-1.5\" />\n                    From Video\n                  </Button>\n                </div>\n                <p className=\"text-xs text-muted-foreground\">\n                  &quot;From Image&quot; uses the recreated image to determine\n                  the character framing. &quot;From Video&quot; uses the\n                  original video framing.\n                </p>\n              </div>\n\n              <Button\n                onClick={handleGenerateVideo}\n                className=\"w-full\"\n                size=\"lg\"\n              >\n                <Clapperboard className=\"h-4 w-4 mr-2\" />\n                Generate Motion Control Video — Est. $0.56-$3.36\n              </Button>\n\n              <p className=\"text-xs text-muted-foreground text-center\">\n                Cost depends on video duration: 5s=$0.56, 10s=$1.12,\n                15s=$1.68, 30s=$3.36\n              </p>\n            </div>\n          )}\n\n          {step === \"generating\" && (\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center gap-2\">\n                <Loader2 className=\"h-4 w-4 animate-spin text-accent-blue\" />\n                <span className=\"text-sm font-medium\">\n                  Generating motion control video...\n                </span>\n                <span className=\"text-xs text-muted-foreground ml-auto\">\n                  {Math.round(elapsedSeconds)}s elapsed\n                </span>\n              </div>\n              <Progress value={progressPercent} className=\"h-2\" />\n              <p className=\"text-xs text-muted-foreground text-center\">\n                {pollCount < 20 &&\n                  \"Processing with Kling 2.6 Pro Motion Control. This usually takes 3-8 minutes...\"}\n                {pollCount >= 20 &&\n                  pollCount < 60 &&\n                  \"Still generating. Kling 2.6 Pro produces high-quality output...\"}\n                {pollCount >= 60 && \"Almost there. Please wait...\"}\n              </p>\n            </div>\n          )}\n\n          {step === \"completed\" && resultVideoUrl && (\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"h-4 w-4 text-green-500\" />\n                <span className=\"text-sm font-medium\">\n                  Motion control video generated!\n                </span>\n              </div>\n              <video\n                controls\n                src={resultVideoUrl}\n                className=\"w-full max-h-[400px] rounded-md bg-black\"\n                preload=\"metadata\"\n              />\n              <div className=\"flex gap-2\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => {\n                    const a = document.createElement(\"a\");\n                    a.href = resultVideoUrl;\n                    a.download = \"motion-control.mp4\";\n                    a.target = \"_blank\";\n                    a.click();\n                  }}\n                >\n                  <Download className=\"h-3.5 w-3.5 mr-1\" />\n                  Download\n                </Button>\n                {savedAssetId ? (\n                  <Badge variant=\"secondary\" className=\"gap-1\">\n                    <CheckCircle2 className=\"h-3 w-3\" />\n                    Saved\n                  </Badge>\n                ) : (\n                  <Button size=\"sm\" onClick={handleSave} disabled={saving}>\n                    {saving ? (\n                      <Loader2 className=\"h-3.5 w-3.5 mr-1 animate-spin\" />\n                    ) : (\n                      <Save className=\"h-3.5 w-3.5 mr-1\" />\n                    )}\n                    {saving ? \"Saving...\" : \"Save to Library\"}\n                  </Button>\n                )}\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={handleReset}\n                >\n                  <RefreshCw className=\"h-3.5 w-3.5 mr-1\" />\n                  New Video\n                </Button>\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* ── Error display ────────────────────────────────────────── */}\n      {error && (\n        <Alert variant=\"destructive\">\n          <AlertCircle className=\"h-4 w-4\" />\n          <AlertDescription className=\"flex items-center justify-between\">\n            <span>{error}</span>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={handleRetry}\n              className=\"ml-3 flex-shrink-0\"\n            >\n              <RefreshCw className=\"h-3.5 w-3.5 mr-1\" />\n              Retry\n            </Button>\n          </AlertDescription>\n        </Alert>\n      )}\n\n      {/* ── Cost summary ─────────────────────────────────────────── */}\n      <div className=\"rounded-lg border border-border bg-card/50 p-4\">\n        <h4 className=\"text-sm font-medium mb-2\">Pipeline Cost Breakdown</h4>\n        <div className=\"grid grid-cols-3 gap-4 text-xs text-muted-foreground\">\n          <div>\n            <span className=\"font-medium text-foreground\">Frame Extraction</span>\n            <br />\n            Free (FFmpeg)\n          </div>\n          <div>\n            <span className=\"font-medium text-foreground\">Image Recreation</span>\n            <br />\n            ~$0.14 (Nano Banana Pro)\n          </div>\n          <div>\n            <span className=\"font-medium text-foreground\">Motion Control</span>\n            <br />\n            $0.56-$3.36 (Kling 2.6 Pro)\n          </div>\n        </div>\n        <p className=\"text-xs text-muted-foreground mt-2\">\n          Total estimated cost per video: ~$0.70-$3.50 depending on duration\n        </p>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}