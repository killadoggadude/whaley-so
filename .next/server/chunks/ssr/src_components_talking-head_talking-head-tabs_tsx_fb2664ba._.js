module.exports=[7273,a=>{"use strict";var b=a.i(87924),c=a.i(75083),d=a.i(72131),e=a.i(99570),f=a.i(86304),g=a.i(68114),h=a.i(70106);let i=(0,h.default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var j=a.i(32860),k=a.i(4720);let l=(0,h.default)("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var m=a.i(4975),n=a.i(79165),o=a.i(64791),p=a.i(25015),q=a.i(69922),r=a.i(66718),s=a.i(70430),t=a.i(24348),u=a.i(96221),v=a.i(92e3),w=a.i(23292);function x({videoUrl:a,onVideoUrlChange:c,onTranscriptReady:f}){let[g,h]=(0,d.useState)(!1),[i,j]=(0,d.useState)(null),k=async()=>{if(!a.trim())return void w.toast.error("Please enter a video URL");h(!0),j(null);try{let b=await fetch("/api/transcribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({urls:[a.trim()]})}),c=await b.json();if(!b.ok)return void j(c.error||"Transcription failed");if(!c.results||0===c.results.length)return void j("No transcription results returned");let d=c.results[0];if(d.error)return void j(d.error);if(!d.transcript||0===d.transcript.trim().length)return void j("No speech detected in the video");w.toast.success(`Transcribed ${d.word_count} words from ${d.platform}`),f(d.transcript)}catch{j("Failed to transcribe video. Check your WaveSpeed API key.")}finally{h(!1)}};return(0,b.jsxs)("div",{className:"max-w-xl mx-auto space-y-4",children:[(0,b.jsxs)("div",{className:"text-center space-y-2",children:[(0,b.jsx)("div",{className:"mx-auto w-12 h-12 rounded-full bg-accent-blue/10 flex items-center justify-center",children:(0,b.jsx)(q.Link2,{className:"h-6 w-6 text-accent-blue"})}),(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Enter Video URL"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Paste a video URL to transcribe. Supports Instagram, TikTok, YouTube, and X."})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{htmlFor:"video-url",children:"Video URL"}),(0,b.jsx)(r.Input,{id:"video-url",placeholder:"https://www.instagram.com/reel/...",value:a,onChange:a=>c(a.target.value),disabled:g})]}),i&&(0,b.jsxs)(t.Alert,{variant:"destructive",children:[(0,b.jsx)(v.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(t.AlertDescription,{children:i})]}),(0,b.jsx)(e.Button,{onClick:k,disabled:g||!a.trim(),className:"w-full",size:"lg",children:g?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(u.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Transcribing..."]}):"Transcribe Video"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground text-center",children:"Powered by WaveSpeed AI Whisper. You can also skip this step and type your script manually."}),(0,b.jsx)(e.Button,{variant:"link",className:"w-full text-xs",onClick:()=>f(""),children:"Skip — write script manually"})]})}function y({transcript:a,onUseAsScript:c}){let d=a.trim().split(/\s+/).filter(a=>a.length>0).length;return a.trim()?(0,b.jsxs)("div",{className:"max-w-xl mx-auto space-y-4",children:[(0,b.jsxs)("div",{className:"text-center space-y-2",children:[(0,b.jsx)("div",{className:"mx-auto w-12 h-12 rounded-full bg-accent-blue/10 flex items-center justify-center",children:(0,b.jsx)(k.FileText,{className:"h-6 w-6 text-accent-blue"})}),(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Transcript Ready"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Review the transcription below. You'll be able to edit it in the next step."})]}),(0,b.jsxs)("div",{className:"rounded-lg bg-card p-4 space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:"Transcription"}),(0,b.jsxs)(f.Badge,{variant:"secondary",children:[d," ",1===d?"word":"words"]})]}),(0,b.jsx)("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:a})]}),(0,b.jsxs)(e.Button,{onClick:c,className:"w-full",size:"lg",children:["Continue to Edit Script",(0,b.jsx)(j.ArrowRight,{className:"h-4 w-4 ml-2"})]})]}):(0,b.jsxs)("div",{className:"max-w-xl mx-auto space-y-4 text-center",children:[(0,b.jsx)("div",{className:"mx-auto w-12 h-12 rounded-full bg-muted flex items-center justify-center",children:(0,b.jsx)(k.FileText,{className:"h-6 w-6 text-muted-foreground"})}),(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"No Transcript"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"You skipped transcription. Continue to write your script manually."}),(0,b.jsxs)(e.Button,{onClick:c,size:"lg",children:["Write Script",(0,b.jsx)(j.ArrowRight,{className:"h-4 w-4 ml-2"})]})]})}var z=a.i(29246);function A({script:a,onScriptChange:c}){let d=a.trim().split(/\s+/).filter(a=>a.length>0).length,e=a.length;return(0,b.jsxs)("div",{className:"max-w-xl mx-auto space-y-4",children:[(0,b.jsxs)("div",{className:"text-center space-y-2",children:[(0,b.jsx)("div",{className:"mx-auto w-12 h-12 rounded-full bg-accent-blue/10 flex items-center justify-center",children:(0,b.jsx)(l,{className:"h-6 w-6 text-accent-blue"})}),(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Edit Script"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Edit the script that will be converted to speech. Remove filler words, fix errors, or rewrite as needed."})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(s.Label,{htmlFor:"script",children:"Script"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(f.Badge,{variant:"outline",className:"text-xs",children:[d," ",1===d?"word":"words"]}),(0,b.jsxs)(f.Badge,{variant:"outline",className:"text-xs",children:[e," chars"]})]})]}),(0,b.jsx)(z.Textarea,{id:"script",value:a,onChange:a=>c(a.target.value),rows:12,placeholder:"Type or paste your script here...",className:"resize-y"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"This text will be spoken by your AI model's voice in the next step. Use the Next button to continue."})]})}var B=a.i(80701),C=a.i(3320),D=a.i(67453);async function E(a){try{if(!(await fetch(a,{method:"HEAD"})).ok)return console.error("Failed to fetch audio file"),null;let b=new Audio(a);return new Promise(a=>{b.addEventListener("loadedmetadata",()=>{let c=b.duration;a(c)}),b.addEventListener("error",()=>{console.error("Failed to load audio metadata"),a(null)}),b.load()})}catch(a){return console.error("Error getting audio duration:",a),null}}function F(a,b){let c=Math.min(a,600),d=Math.max(c*("480p"===b?.03:.06),.15);return{duration:c,cost:parseFloat(d.toFixed(2))}}function G({script:a,aiModels:c,selectedModel:f,onModelChange:g,audioUrl:h,onAudioGenerated:i}){let[j,k]=(0,d.useState)(!1),[l,n]=(0,d.useState)(!1),[o,p]=(0,d.useState)(null),q=c.filter(a=>a.voice_id&&a.voice_id.trim()),r=parseFloat((22e-5*a.length).toFixed(2)),x=async()=>{if(!f)return void w.toast.error("Select an AI model first");if(!a.trim())return void w.toast.error("Script is empty");k(!0),p(null);try{let b=await fetch("/api/tts/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:a,voice_id:f.voice_id,settings:f.voice_settings})});if(!b.ok){let a=await b.json().catch(()=>null);p(a?.error||`TTS generation failed (${b.status})`);return}let c=await b.blob(),d=URL.createObjectURL(c);n(!0);let e=new FormData;e.append("file",c,"talking-head-audio.mp3");let g=await fetch("/api/talking-head/upload-audio",{method:"POST",body:e}),h=await g.json();if(!g.ok)return void p(h.error||"Failed to upload audio");w.toast.success("Voice generated and uploaded"),i(d,h.signedUrl)}catch{p("Failed to generate voice. Check your ElevenLabs API key.")}finally{k(!1),n(!1)}};return(0,b.jsxs)("div",{className:"max-w-xl mx-auto space-y-4",children:[(0,b.jsxs)("div",{className:"text-center space-y-2",children:[(0,b.jsx)("div",{className:"mx-auto w-12 h-12 rounded-full bg-accent-blue/10 flex items-center justify-center",children:(0,b.jsx)(m.Mic,{className:"h-6 w-6 text-accent-blue"})}),(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Generate Voice"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Select an AI model and generate the voiceover for your script."})]}),0===q.length?(0,b.jsxs)(t.Alert,{children:[(0,b.jsx)(v.AlertCircle,{className:"h-4 w-4"}),(0,b.jsxs)(t.AlertDescription,{children:["No AI models with voice configured. Add voice settings (ElevenLabs voice ID) to your models in the"," ",(0,b.jsx)("a",{href:"/dashboard/models",className:"underline font-medium",children:"AI Models"})," ","page."]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{children:"AI Model"}),(0,b.jsxs)(B.Select,{value:f?.id||"",onValueChange:a=>{g(q.find(b=>b.id===a)||null)},children:[(0,b.jsx)(B.SelectTrigger,{className:"w-full",children:(0,b.jsx)(B.SelectValue,{placeholder:"Select an AI model..."})}),(0,b.jsx)(B.SelectContent,{children:q.map(a=>(0,b.jsx)(B.SelectItem,{value:a.id,children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[a.reference_images.length>0?(0,b.jsx)("img",{src:a.reference_images[0].signed_url,alt:"",className:"h-5 w-5 rounded-sm object-cover"}):(0,b.jsx)(m.Mic,{className:"h-3.5 w-3.5 text-muted-foreground"}),a.name]})},a.id))})]})]}),f&&(0,b.jsxs)("div",{className:"rounded-lg bg-card p-3 space-y-1.5",children:[(0,b.jsx)("p",{className:"text-xs font-medium",children:"Voice Settings"}),(0,b.jsxs)("div",{className:"flex gap-3 text-xs text-muted-foreground",children:[(0,b.jsxs)("span",{children:["Stability: ",f.voice_settings.stability]}),(0,b.jsxs)("span",{children:["Similarity:"," ",f.voice_settings.similarity_boost]}),(0,b.jsxs)("span",{children:["Style: ",f.voice_settings.style]})]})]}),(0,b.jsxs)("div",{className:"rounded-lg bg-card p-3",children:[(0,b.jsx)("p",{className:"text-xs font-medium mb-1",children:"Script Preview"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-3",children:a})]}),(0,b.jsxs)("div",{className:"rounded-lg bg-card p-3 space-y-1",children:[(0,b.jsx)("p",{className:"text-xs font-medium mb-1",children:"Estimated Cost"}),(0,b.jsxs)("div",{className:"flex items-center justify-center py-2 bg-muted/50 rounded",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground mr-2",children:"Total:"}),(0,b.jsxs)("span",{className:"text-2xl font-semibold text-green-600",children:["$",r.toFixed(2)]})]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground text-center",children:["Based on ",a.length," characters at ~$0.00022/char"]})]}),o&&(0,b.jsxs)(t.Alert,{variant:"destructive",children:[(0,b.jsx)(v.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(t.AlertDescription,{children:o})]}),(0,b.jsx)(e.Button,{onClick:x,disabled:j||l||!f,className:"w-full",size:"lg",children:j?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(u.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating voice..."]}):l?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(u.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Uploading audio..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(m.Mic,{className:"h-4 w-4 mr-2"}),"Generate Voice — Est. $",r.toFixed(2)]})}),h&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(D.CheckCircle2,{className:"h-4 w-4 text-green-500"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:"Audio Ready"})]}),(0,b.jsx)(C.AudioPlayer,{audioUrl:h}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Use the Next button to continue to image selection."})]})]})]})}var H=a.i(87532),I=a.i(33441),J=a.i(73320),K=a.i(50558);function L({selectedModel:a,selectedImageId:c,onImageSelect:h}){let[i,j]=(0,d.useState)([]),[k,l]=(0,d.useState)(0),[m,o]=(0,d.useState)(!1),[p,q]=(0,d.useState)(""),[s,x]=(0,d.useState)(!1),[y,z]=(0,d.useState)(!1),[A,B]=(0,d.useState)(null),C=(0,d.useRef)(null),D=a?.reference_images||[],E=D.length>0,F=(0,d.useCallback)(async a=>{o(!0);let b=a?i.length:0,c=await (0,K.getAssetsAction)({file_type:"image",search:p||void 0,sort_by:"created_at",sort_order:"desc",limit:30,offset:b});a?j(a=>[...a,...c.assets]):j(c.assets),l(c.total),o(!1)},[p,i.length]);(0,d.useEffect)(()=>{(s||!E)&&F(!1)},[s,E]);let G=async a=>{let b=a.target.files?.[0];if(b){if(!b.type.startsWith("image/"))return void w.toast.error("Please select an image file");if(b.size>0x3200000)return void w.toast.error("File exceeds 50MB size limit");z(!0),B(null);try{let a=new FormData;a.append("file",b),a.append("tags",JSON.stringify(["talking-head","portrait"]));let c=await fetch("/api/assets/upload",{method:"POST",body:a}),d=await c.json();if(!c.ok)return void B(d.error||"Upload failed");w.toast.success("Image uploaded!");let e=await (0,K.getAssetsAction)({file_type:"image",sort_by:"created_at",sort_order:"desc",limit:30,offset:0});j(e.assets),l(e.total),x(!0);let f=e.assets.find(a=>a.id===d.asset.id);f&&h(f.id,f.signed_url)}catch{B("Failed to upload image")}finally{z(!1),C.current&&(C.current.value="")}}},L=!s&&E?D:i;return(0,b.jsxs)("div",{className:"max-w-2xl mx-auto space-y-4",children:[(0,b.jsxs)("div",{className:"text-center space-y-2",children:[(0,b.jsx)("div",{className:"mx-auto w-12 h-12 rounded-full bg-accent-blue/10 flex items-center justify-center",children:(0,b.jsx)(n.ImageIcon,{className:"h-6 w-6 text-accent-blue"})}),(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Select Portrait Image"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Choose a portrait image for the talking head video. A clear front-facing photo works best."})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[E&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(e.Button,{variant:s?"outline":"default",size:"sm",onClick:()=>x(!1),children:[a?.name,"'s Images (",D.length,")"]}),(0,b.jsx)(e.Button,{variant:s?"default":"outline",size:"sm",onClick:()=>x(!0),children:"All Images"})]}),(0,b.jsxs)("div",{className:"ml-auto",children:[(0,b.jsx)("input",{ref:C,type:"file",accept:"image/*",onChange:G,className:"hidden"}),(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",onClick:()=>C.current?.click(),disabled:y,children:[y?(0,b.jsx)(u.Loader2,{className:"h-4 w-4 mr-1.5 animate-spin"}):(0,b.jsx)(J.Upload,{className:"h-4 w-4 mr-1.5"}),y?"Uploading...":"Upload Image"]})]})]}),A&&(0,b.jsxs)(t.Alert,{variant:"destructive",children:[(0,b.jsx)(v.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(t.AlertDescription,{children:A})]}),(s||!E)&&(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(H.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(r.Input,{placeholder:"Search images...",value:p,onChange:a=>{let b;return q(a.target.value),b=setTimeout(()=>F(!1),300),()=>clearTimeout(b)},className:"pl-9"})]}),0!==L.length||m?(0,b.jsx)("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-2",children:L.map(a=>{let d=c===a.id;return(0,b.jsxs)("button",{type:"button",className:(0,g.cn)("relative aspect-square overflow-hidden rounded-md border-2 transition-all",d?"border-accent-blue ring-2 ring-accent-blue/20":"border-transparent hover:border-muted-foreground/30"),onClick:()=>h(a.id,a.signed_url),children:[(0,b.jsx)("img",{src:a.signed_url,alt:a.filename,className:"h-full w-full object-cover",loading:"lazy"}),d&&(0,b.jsx)("div",{className:"absolute inset-0 bg-accent-blue/20 flex items-center justify-center",children:(0,b.jsx)("div",{className:"h-6 w-6 rounded-full bg-accent-blue flex items-center justify-center",children:(0,b.jsx)(I.Check,{className:"h-4 w-4 text-primary-foreground"})})})]},a.id)})}):(0,b.jsx)("div",{className:"flex flex-col items-center justify-center py-12 space-y-3",children:(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["No images found. Upload an image above or add images in the"," ",(0,b.jsx)("a",{href:"/dashboard/assets",className:"underline font-medium",children:"Asset Library"}),"."]})}),(s||!E)&&i.length<k&&(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>F(!0),disabled:m,children:m?(0,b.jsx)(u.Loader2,{className:"h-4 w-4 animate-spin"}):"Load More"})}),c&&(0,b.jsxs)("div",{className:"flex items-center gap-2 justify-center",children:[(0,b.jsxs)(f.Badge,{variant:"secondary",className:"gap-1",children:[(0,b.jsx)(I.Check,{className:"h-3 w-3"}),"Image selected"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Use the Next button to continue."})]})]})}var M=a.i(7554),N=a.i(70121),O=a.i(50104),P=a.i(25152),Q=a.i(77994),R=a.i(3688),S=a.i(30553),T="Switch",[U,V]=(0,O.createContextScope)(T),[W,X]=U(T),Y=d.forwardRef((a,c)=>{let{__scopeSwitch:e,name:f,checked:g,defaultChecked:h,required:i,disabled:j,value:k="on",onCheckedChange:l,form:m,...n}=a,[o,p]=d.useState(null),q=(0,N.useComposedRefs)(c,a=>p(a)),r=d.useRef(!1),s=!o||m||!!o.closest("form"),[t,u]=(0,P.useControllableState)({prop:g,defaultProp:h??!1,onChange:l,caller:T});return(0,b.jsxs)(W,{scope:e,checked:t,disabled:j,children:[(0,b.jsx)(S.Primitive.button,{type:"button",role:"switch","aria-checked":t,"aria-required":i,"data-state":aa(t),"data-disabled":j?"":void 0,disabled:j,value:k,...n,ref:q,onClick:(0,M.composeEventHandlers)(a.onClick,a=>{u(a=>!a),s&&(r.current=a.isPropagationStopped(),r.current||a.stopPropagation())})}),s&&(0,b.jsx)(_,{control:o,bubbles:!r.current,name:f,value:k,checked:t,required:i,disabled:j,form:m,style:{transform:"translateX(-100%)"}})]})});Y.displayName=T;var Z="SwitchThumb",$=d.forwardRef((a,c)=>{let{__scopeSwitch:d,...e}=a,f=X(Z,d);return(0,b.jsx)(S.Primitive.span,{"data-state":aa(f.checked),"data-disabled":f.disabled?"":void 0,...e,ref:c})});$.displayName=Z;var _=d.forwardRef(({__scopeSwitch:a,control:c,checked:e,bubbles:f=!0,...g},h)=>{let i=d.useRef(null),j=(0,N.useComposedRefs)(i,h),k=(0,Q.usePrevious)(e),l=(0,R.useSize)(c);return d.useEffect(()=>{let a=i.current;if(!a)return;let b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(k!==e&&b){let c=new Event("click",{bubbles:f});b.call(a,e),a.dispatchEvent(c)}},[k,e,f]),(0,b.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:e,...g,tabIndex:-1,ref:j,style:{...g.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function aa(a){return a?"checked":"unchecked"}_.displayName="SwitchBubbleInput",a.s(["Root",()=>Y,"Switch",()=>Y,"SwitchThumb",()=>$,"Thumb",()=>$,"createSwitchScope",()=>V],19025);var ab=a.i(19025),ab=ab;function ac({className:a,size:c="default",...d}){return(0,b.jsx)(ab.Root,{"data-slot":"switch","data-size":c,className:(0,g.cn)("peer data-[state=checked]:bg-accent-blue data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 group/switch inline-flex shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-[1.15rem] data-[size=default]:w-8 data-[size=sm]:h-3.5 data-[size=sm]:w-6",a),...d,children:(0,b.jsx)(ab.Thumb,{"data-slot":"switch-thumb",className:(0,g.cn)("bg-background data-[state=unchecked]:bg-foreground data-[state=checked]:bg-accent-blue-foreground pointer-events-none block rounded-full ring-0 transition-transform group-data-[size=default]/switch:size-4 group-data-[size=sm]/switch:size-3 data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}var ad=a.i(73390),ae=a.i(69520);let af=(0,h.default)("captions",[["rect",{width:"18",height:"14",x:"3",y:"5",rx:"2",ry:"2",key:"12ruh7"}],["path",{d:"M7 15h4M15 15h2M7 11h2M13 11h4",key:"1ueiar"}]]);var ag=a.i(85181),ah=a.i(96743),ai=a.i(92843),aj=a.i(4691),ak=a.i(92616),al=a.i(77192),am=a.i(11011),an=a.i(28094),[ao,ap]=(0,O.createContextScope)("Tooltip",[aj.createPopperScope]),aq=(0,aj.createPopperScope)(),ar="TooltipProvider",as="tooltip.open",[at,au]=ao(ar),av=a=>{let{__scopeTooltip:c,delayDuration:e=700,skipDelayDuration:f=300,disableHoverableContent:g=!1,children:h}=a,i=d.useRef(!0),j=d.useRef(!1),k=d.useRef(0);return d.useEffect(()=>{let a=k.current;return()=>window.clearTimeout(a)},[]),(0,b.jsx)(at,{scope:c,isOpenDelayedRef:i,delayDuration:e,onOpen:d.useCallback(()=>{window.clearTimeout(k.current),i.current=!1},[]),onClose:d.useCallback(()=>{window.clearTimeout(k.current),k.current=window.setTimeout(()=>i.current=!0,f)},[f]),isPointerInTransitRef:j,onPointerInTransitChange:d.useCallback(a=>{j.current=a},[]),disableHoverableContent:g,children:h})};av.displayName=ar;var aw="Tooltip",[ax,ay]=ao(aw),az=a=>{let{__scopeTooltip:c,children:e,open:f,defaultOpen:g,onOpenChange:h,disableHoverableContent:i,delayDuration:j}=a,k=au(aw,a.__scopeTooltip),l=aq(c),[m,n]=d.useState(null),o=(0,ai.useId)(),p=d.useRef(0),q=i??k.disableHoverableContent,r=j??k.delayDuration,s=d.useRef(!1),[t,u]=(0,P.useControllableState)({prop:f,defaultProp:g??!1,onChange:a=>{a?(k.onOpen(),document.dispatchEvent(new CustomEvent(as))):k.onClose(),h?.(a)},caller:aw}),v=d.useMemo(()=>t?s.current?"delayed-open":"instant-open":"closed",[t]),w=d.useCallback(()=>{window.clearTimeout(p.current),p.current=0,s.current=!1,u(!0)},[u]),x=d.useCallback(()=>{window.clearTimeout(p.current),p.current=0,u(!1)},[u]),y=d.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{s.current=!0,u(!0),p.current=0},r)},[r,u]);return d.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),(0,b.jsx)(aj.Root,{...l,children:(0,b.jsx)(ax,{scope:c,contentId:o,open:t,stateAttribute:v,trigger:m,onTriggerChange:n,onTriggerEnter:d.useCallback(()=>{k.isOpenDelayedRef.current?y():w()},[k.isOpenDelayedRef,y,w]),onTriggerLeave:d.useCallback(()=>{q?x():(window.clearTimeout(p.current),p.current=0)},[x,q]),onOpen:w,onClose:x,disableHoverableContent:q,children:e})})};az.displayName=aw;var aA="TooltipTrigger",aB=d.forwardRef((a,c)=>{let{__scopeTooltip:e,...f}=a,g=ay(aA,e),h=au(aA,e),i=aq(e),j=d.useRef(null),k=(0,N.useComposedRefs)(c,j,g.onTriggerChange),l=d.useRef(!1),m=d.useRef(!1),n=d.useCallback(()=>l.current=!1,[]);return d.useEffect(()=>()=>document.removeEventListener("pointerup",n),[n]),(0,b.jsx)(aj.Anchor,{asChild:!0,...i,children:(0,b.jsx)(S.Primitive.button,{"aria-describedby":g.open?g.contentId:void 0,"data-state":g.stateAttribute,...f,ref:k,onPointerMove:(0,M.composeEventHandlers)(a.onPointerMove,a=>{"touch"!==a.pointerType&&(m.current||h.isPointerInTransitRef.current||(g.onTriggerEnter(),m.current=!0))}),onPointerLeave:(0,M.composeEventHandlers)(a.onPointerLeave,()=>{g.onTriggerLeave(),m.current=!1}),onPointerDown:(0,M.composeEventHandlers)(a.onPointerDown,()=>{g.open&&g.onClose(),l.current=!0,document.addEventListener("pointerup",n,{once:!0})}),onFocus:(0,M.composeEventHandlers)(a.onFocus,()=>{l.current||g.onOpen()}),onBlur:(0,M.composeEventHandlers)(a.onBlur,g.onClose),onClick:(0,M.composeEventHandlers)(a.onClick,g.onClose)})})});aB.displayName=aA;var aC="TooltipPortal",[aD,aE]=ao(aC,{forceMount:void 0}),aF=a=>{let{__scopeTooltip:c,forceMount:d,children:e,container:f}=a,g=ay(aC,c);return(0,b.jsx)(aD,{scope:c,forceMount:d,children:(0,b.jsx)(al.Presence,{present:d||g.open,children:(0,b.jsx)(ak.Portal,{asChild:!0,container:f,children:e})})})};aF.displayName=aC;var aG="TooltipContent",aH=d.forwardRef((a,c)=>{let d=aE(aG,a.__scopeTooltip),{forceMount:e=d.forceMount,side:f="top",...g}=a,h=ay(aG,a.__scopeTooltip);return(0,b.jsx)(al.Presence,{present:e||h.open,children:h.disableHoverableContent?(0,b.jsx)(aM,{side:f,...g,ref:c}):(0,b.jsx)(aI,{side:f,...g,ref:c})})}),aI=d.forwardRef((a,c)=>{let e=ay(aG,a.__scopeTooltip),f=au(aG,a.__scopeTooltip),g=d.useRef(null),h=(0,N.useComposedRefs)(c,g),[i,j]=d.useState(null),{trigger:k,onClose:l}=e,m=g.current,{onPointerInTransitChange:n}=f,o=d.useCallback(()=>{j(null),n(!1)},[n]),p=d.useCallback((a,b)=>{let c,d=a.currentTarget,e={x:a.clientX,y:a.clientY},f=function(a,b){let c=Math.abs(b.top-a.y),d=Math.abs(b.bottom-a.y),e=Math.abs(b.right-a.x),f=Math.abs(b.left-a.x);switch(Math.min(c,d,e,f)){case f:return"left";case e:return"right";case c:return"top";case d:return"bottom";default:throw Error("unreachable")}}(e,d.getBoundingClientRect());j(((c=[...function(a,b,c=5){let d=[];switch(b){case"top":d.push({x:a.x-c,y:a.y+c},{x:a.x+c,y:a.y+c});break;case"bottom":d.push({x:a.x-c,y:a.y-c},{x:a.x+c,y:a.y-c});break;case"left":d.push({x:a.x+c,y:a.y-c},{x:a.x+c,y:a.y+c});break;case"right":d.push({x:a.x-c,y:a.y-c},{x:a.x-c,y:a.y+c})}return d}(e,f),...function(a){let{top:b,right:c,bottom:d,left:e}=a;return[{x:e,y:b},{x:c,y:b},{x:c,y:d},{x:e,y:d}]}(b.getBoundingClientRect())].slice()).sort((a,b)=>a.x<b.x?-1:a.x>b.x?1:a.y<b.y?-1:1*!!(a.y>b.y)),function(a){if(a.length<=1)return a.slice();let b=[];for(let c=0;c<a.length;c++){let d=a[c];for(;b.length>=2;){let a=b[b.length-1],c=b[b.length-2];if((a.x-c.x)*(d.y-c.y)>=(a.y-c.y)*(d.x-c.x))b.pop();else break}b.push(d)}b.pop();let c=[];for(let b=a.length-1;b>=0;b--){let d=a[b];for(;c.length>=2;){let a=c[c.length-1],b=c[c.length-2];if((a.x-b.x)*(d.y-b.y)>=(a.y-b.y)*(d.x-b.x))c.pop();else break}c.push(d)}return(c.pop(),1===b.length&&1===c.length&&b[0].x===c[0].x&&b[0].y===c[0].y)?b:b.concat(c)}(c))),n(!0)},[n]);return d.useEffect(()=>()=>o(),[o]),d.useEffect(()=>{if(k&&m){let a=a=>p(a,m),b=a=>p(a,k);return k.addEventListener("pointerleave",a),m.addEventListener("pointerleave",b),()=>{k.removeEventListener("pointerleave",a),m.removeEventListener("pointerleave",b)}}},[k,m,p,o]),d.useEffect(()=>{if(i){let a=a=>{let b=a.target,c={x:a.clientX,y:a.clientY},d=k?.contains(b)||m?.contains(b),e=!function(a,b){let{x:c,y:d}=a,e=!1;for(let a=0,f=b.length-1;a<b.length;f=a++){let g=b[a],h=b[f],i=g.x,j=g.y,k=h.x,l=h.y;j>d!=l>d&&c<(k-i)*(d-j)/(l-j)+i&&(e=!e)}return e}(c,i);d?o():e&&(o(),l())};return document.addEventListener("pointermove",a),()=>document.removeEventListener("pointermove",a)}},[k,m,i,l,o]),(0,b.jsx)(aM,{...a,ref:h})}),[aJ,aK]=ao(aw,{isInside:!1}),aL=(0,am.createSlottable)("TooltipContent"),aM=d.forwardRef((a,c)=>{let{__scopeTooltip:e,children:f,"aria-label":g,onEscapeKeyDown:h,onPointerDownOutside:i,...j}=a,k=ay(aG,e),l=aq(e),{onClose:m}=k;return d.useEffect(()=>(document.addEventListener(as,m),()=>document.removeEventListener(as,m)),[m]),d.useEffect(()=>{if(k.trigger){let a=a=>{let b=a.target;b?.contains(k.trigger)&&m()};return window.addEventListener("scroll",a,{capture:!0}),()=>window.removeEventListener("scroll",a,{capture:!0})}},[k.trigger,m]),(0,b.jsx)(ah.DismissableLayer,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:h,onPointerDownOutside:i,onFocusOutside:a=>a.preventDefault(),onDismiss:m,children:(0,b.jsxs)(aj.Content,{"data-state":k.stateAttribute,...l,...j,ref:c,style:{...j.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[(0,b.jsx)(aL,{children:f}),(0,b.jsx)(aJ,{scope:e,isInside:!0,children:(0,b.jsx)(an.Root,{id:k.contentId,role:"tooltip",children:g||f})})]})})});aH.displayName=aG;var aN="TooltipArrow",aO=d.forwardRef((a,c)=>{let{__scopeTooltip:d,...e}=a,f=aq(d);return aK(aN,d).isInside?null:(0,b.jsx)(aj.Arrow,{...f,...e,ref:c})});aO.displayName=aN,a.s(["Arrow",()=>aO,"Content",()=>aH,"Portal",()=>aF,"Provider",()=>av,"Root",()=>az,"Tooltip",()=>az,"TooltipArrow",()=>aO,"TooltipContent",()=>aH,"TooltipPortal",()=>aF,"TooltipProvider",()=>av,"TooltipTrigger",()=>aB,"Trigger",()=>aB,"createTooltipScope",()=>ap],99811);var aP=a.i(99811),aP=aP;function aQ({delayDuration:a=0,...c}){return(0,b.jsx)(aP.Provider,{"data-slot":"tooltip-provider",delayDuration:a,...c})}function aR({...a}){return(0,b.jsx)(aP.Root,{"data-slot":"tooltip",...a})}function aS({...a}){return(0,b.jsx)(aP.Trigger,{"data-slot":"tooltip-trigger",...a})}function aT({className:a,sideOffset:c=0,children:d,...e}){return(0,b.jsx)(aP.Portal,{children:(0,b.jsxs)(aP.Content,{"data-slot":"tooltip-content",sideOffset:c,className:(0,g.cn)("bg-foreground text-background animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",a),...e,children:[d,(0,b.jsx)(aP.Arrow,{className:"bg-foreground fill-foreground z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}let aU=(0,h.default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),aV=(0,h.default)("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]),aW=(0,h.default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var aX=a.i(33508),aY=a.i(14548);let aZ=["Arial","Helvetica","Impact","Georgia","Verdana","Trebuchet MS","Courier New","Comic Sans MS","Futura","Tahoma"],a$={fontFamily:"Arial",fontSize:60,textColor:"#FFFFFF",highlightColor:"#FFFF00",backgroundColor:"",backgroundOpacity:60,outlineColor:"#000000",outlineWidth:3,bold:!0,italic:!1,wordsPerPage:3,position:"center",verticalPosition:50},a_=[{id:"classic-tiktok",name:"Classic TikTok",settings:{fontFamily:"Impact",fontSize:60,textColor:"#FFFFFF",highlightColor:"#FFFF00",backgroundColor:"",backgroundOpacity:60,outlineColor:"#000000",outlineWidth:3,bold:!0,italic:!1,wordsPerPage:2,position:"center",verticalPosition:50},previewBg:"bg-black",previewText:"text-white",previewHighlight:"text-yellow-400"},{id:"capcut-pop",name:"CapCut Pop",settings:{fontFamily:"Arial",fontSize:64,textColor:"#FFFFFF",highlightColor:"#00D9FF",backgroundColor:"",backgroundOpacity:60,outlineColor:"#000000",outlineWidth:4,bold:!0,italic:!1,wordsPerPage:2,position:"center",verticalPosition:50},previewBg:"bg-black",previewText:"text-white",previewHighlight:"text-cyan-400"},{id:"neon-highlight",name:"Neon Highlight",settings:{fontFamily:"Arial",fontSize:58,textColor:"#FFFFFF",highlightColor:"#39FF14",backgroundColor:"",backgroundOpacity:60,outlineColor:"#00FF00",outlineWidth:2,bold:!0,italic:!1,wordsPerPage:3,position:"center",verticalPosition:50},previewBg:"bg-black",previewText:"text-white",previewHighlight:"text-lime-400"},{id:"bold-minimal",name:"Bold Minimal",settings:{fontFamily:"Arial",fontSize:56,textColor:"#FFFFFF",highlightColor:"#FFFFFF",backgroundColor:"",backgroundOpacity:60,outlineColor:"#000000",outlineWidth:1,bold:!0,italic:!1,wordsPerPage:3,position:"center",verticalPosition:50},previewBg:"bg-black",previewText:"text-white",previewHighlight:"text-white"},{id:"warm-viral",name:"Warm Viral",settings:{fontFamily:"Arial",fontSize:62,textColor:"#FFFFFF",highlightColor:"#FF6B35",backgroundColor:"",backgroundOpacity:60,outlineColor:"#4A2C2A",outlineWidth:3,bold:!0,italic:!1,wordsPerPage:2,position:"center",verticalPosition:50},previewBg:"bg-black",previewText:"text-white",previewHighlight:"text-orange-500"},{id:"clean-subtitle",name:"Clean Subtitle",settings:{fontFamily:"Arial",fontSize:52,textColor:"#FFFFFF",highlightColor:"#87CEEB",backgroundColor:"",backgroundOpacity:60,outlineColor:"#000000",outlineWidth:2,bold:!1,italic:!1,wordsPerPage:3,position:"bottom",verticalPosition:70},previewBg:"bg-black",previewText:"text-white",previewHighlight:"text-sky-400"}];function a0(a,b=0){let c=a.replace("#","");if(6!==c.length)return"&H00FFFFFF";let d=c.substring(0,2),e=c.substring(2,4),f=c.substring(4,6),g=Math.round(b/100*255).toString(16).padStart(2,"0").toUpperCase();return`&H${g}${f}${e}${d}`.toUpperCase()}a_.map(a=>(function(a,b,c,d="bg-black",e="text-white",f="text-yellow-400"){let g=Math.round((1-c.verticalPosition/100)*1920),h=c.verticalPosition<=33?8:c.verticalPosition<=66?5:2;return{id:a,name:b,fontFamily:c.fontFamily,fontSize:c.fontSize,primaryColor:a0(c.textColor),highlightColor:a0(c.highlightColor),outlineColor:a0(c.outlineColor),shadowColor:c.backgroundColor?a0(c.backgroundColor,100-c.backgroundOpacity):a0("#000000",80),backgroundColor:c.backgroundColor?a0(c.backgroundColor,100-c.backgroundOpacity):"",outlineWidth:c.outlineWidth,shadowDepth:2*!c.backgroundColor,bold:c.bold,italic:c.italic,alignment:h,marginV:g,wordsPerPage:c.wordsPerPage,previewBg:d,previewText:e,previewHighlight:f}})(a.id,a.name,a.settings,a.previewBg,a.previewText,a.previewHighlight));var a1=a.i(5050);let a2=(0,a1.createServerReference)("00fa4820aecc0a3e59611bf0b7744355af8d4e27c0",a1.callServer,void 0,a1.findSourceMapURL,"getCaptionPresetsAction"),a3=(0,a1.createServerReference)("60f71fc9dc241bb13bca925648e5296866a1ae1431",a1.callServer,void 0,a1.findSourceMapURL,"saveCaptionPresetAction"),a4=(0,a1.createServerReference)("40d147172e8c74ea711433ab0c509a91c9d71086bc",a1.callServer,void 0,a1.findSourceMapURL,"deleteCaptionPresetAction");function a5({presetSettings:a}){return(0,b.jsx)("div",{className:"relative rounded-lg overflow-hidden bg-gradient-to-b from-gray-800 via-gray-900 to-black",style:{width:"70px",height:"120px"},children:(0,b.jsx)("div",{className:"absolute left-0 right-0 flex items-center justify-center px-2",style:{top:`${a.verticalPosition}%`,transform:"translateY(-50%)"},children:(0,b.jsx)("div",{className:"inline-block px-1.5 py-0.5 rounded",style:{backgroundColor:a.backgroundColor?`${a.backgroundColor}${Math.round(a.backgroundOpacity/100*255).toString(16).padStart(2,"0")}`:"transparent"},children:(0,b.jsx)("p",{className:"text-center leading-tight",style:{fontFamily:a.fontFamily,fontSize:`${Math.max(8,.18*a.fontSize)}px`,fontWeight:a.bold?700:400,fontStyle:a.italic?"italic":"normal",textShadow:a.outlineWidth>0?`0 0 ${1.5*a.outlineWidth}px ${a.outlineColor},
                   ${a.outlineWidth}px ${a.outlineWidth}px 0 ${a.outlineColor},
                   -${a.outlineWidth}px -${a.outlineWidth}px 0 ${a.outlineColor},
                   ${a.outlineWidth}px -${a.outlineWidth}px 0 ${a.outlineColor},
                   -${a.outlineWidth}px ${a.outlineWidth}px 0 ${a.outlineColor}`:"none",letterSpacing:"0.02em"},children:["Hello","World"].map((c,d)=>(0,b.jsxs)("span",{style:{color:1===d?a.highlightColor:a.textColor},children:[c," "]},d))})})})})}function a6({settings:a,onChange:c,compact:f=!1}){let[h,i]=(0,d.useState)("classic-tiktok"),j=b=>{i(null),c({...a,...b})},k=["This","is","a","caption","preview"],l=k.slice(0,Math.min(a.wordsPerPage,k.length)),m=Math.min(2,l.length-1),[n,o]=(0,d.useState)([]),[p,q]=(0,d.useState)(!1),[t,u]=(0,d.useState)(""),[v,w]=(0,d.useState)(!1),[x,y]=(0,d.useState)(null),[z,A]=(0,d.useState)(!1);(0,d.useEffect)(()=>{a2().then(({presets:a})=>o(a))},[]);let C=async()=>{if(t.trim()){w(!0);try{let{preset:b}=await a3(t.trim(),a);if(b){q(!1),u(""),A(!0);let{presets:a}=await a2();o(a),A(!1)}}catch{}finally{w(!1)}}},E=async a=>{y(a);try{await a4(a),o(b=>b.filter(b=>b.id!==a))}catch{}finally{y(null)}};return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(s.Label,{className:"text-xs font-medium",children:"Presets"}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsxs)(e.Button,{variant:"ghost",size:"sm",onClick:()=>q(!0),className:"h-6 px-2 text-xs text-muted-foreground",disabled:v||z,children:[(0,b.jsx)(aY.Save,{className:"h-3 w-3 mr-1"}),"Save"]}),(0,b.jsxs)(e.Button,{variant:"ghost",size:"sm",onClick:()=>{i("classic-tiktok"),c({...a$})},className:"h-6 px-2 text-xs text-muted-foreground",children:[(0,b.jsx)(aU,{className:"h-3 w-3 mr-1"}),"Reset"]})]})]}),p&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(r.Input,{placeholder:"Preset name...",value:t,onChange:a=>u(a.target.value),className:"h-8 text-xs",autoFocus:!0,onKeyDown:a=>{"Enter"===a.key&&C(),"Escape"===a.key&&q(!1)}}),(0,b.jsx)(e.Button,{size:"sm",onClick:C,disabled:!t.trim()||v,className:"h-8",children:v?"Saving...":"Save"}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>{q(!1),u("")},className:"h-8",children:"Cancel"})]}),(0,b.jsx)(aQ,{children:(0,b.jsxs)("div",{className:"flex gap-1.5 overflow-x-auto pb-1",children:[a_.map(d=>{let e=h===d.id||JSON.stringify(a)===JSON.stringify(d.settings);return(0,b.jsxs)(aR,{children:[(0,b.jsx)(aS,{asChild:!0,children:(0,b.jsxs)("button",{type:"button",onClick:()=>{var a;let b;return a=d.id,void((b=a_.find(b=>b.id===a))&&(i(a),c({...b.settings})))},className:(0,g.cn)("relative flex-shrink-0 rounded-md border-2 px-2.5 py-1.5 text-xs font-medium transition-all",e?"border-accent-blue bg-accent-blue/5":"border-solid border-border bg-muted/50 hover:border-muted-foreground/30"),children:[e&&(0,b.jsx)(D.CheckCircle2,{className:"absolute -top-1 -right-1 h-3.5 w-3.5 text-accent-blue"}),d.name]})}),(0,b.jsx)(aT,{className:"p-0",children:(0,b.jsx)(a5,{presetSettings:d.settings})})]},d.id)}),n.map(d=>{let e=d.settings,f=h===`saved-${d.id}`||JSON.stringify(a)===JSON.stringify(e);return(0,b.jsxs)(aR,{children:[(0,b.jsx)(aS,{asChild:!0,children:(0,b.jsxs)("button",{type:"button",onClick:()=>{i(`saved-${d.id}`),c({...e})},className:(0,g.cn)("relative flex-shrink-0 rounded-md border-2 px-2.5 py-1.5 text-xs font-medium transition-all group",f?"border-accent-blue bg-accent-blue/5":"border-dashed border-border bg-muted/50 hover:border-muted-foreground/30"),children:[f&&(0,b.jsx)(D.CheckCircle2,{className:"absolute -top-1 -right-1 h-3.5 w-3.5 text-accent-blue"}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)(aW,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{children:d.name})]}),x===d.id?(0,b.jsx)(ae.RefreshCw,{className:"absolute -top-1 -right-1 h-3 w-3 text-muted-foreground animate-spin"}):(0,b.jsx)("button",{type:"button",onClick:a=>{a.stopPropagation(),E(d.id)},className:"hidden group-hover:flex absolute -top-1 -right-1 h-4 w-4 rounded-full bg-destructive text-destructive-foreground items-center justify-center transition-opacity",children:(0,b.jsx)(aX.X,{className:"h-2.5 w-2.5"})})]})}),(0,b.jsx)(aT,{className:"p-0",children:(0,b.jsx)(a5,{presetSettings:e})})]},d.id)})]})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{className:"text-xs font-medium",children:"Preview"}),(0,b.jsxs)("div",{className:"relative rounded-lg overflow-hidden",style:{aspectRatio:"9/16",maxHeight:f?"180px":"240px"},children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-gray-800 via-gray-900 to-black"}),(0,b.jsx)("div",{className:"absolute left-0 right-0 flex items-center justify-center px-4",style:{top:`${a.verticalPosition}%`,transform:"translateY(-50%)"},children:(0,b.jsx)("div",{className:"inline-block px-3 py-1.5 rounded",style:{backgroundColor:a.backgroundColor?`${a.backgroundColor}${Math.round(a.backgroundOpacity/100*255).toString(16).padStart(2,"0")}`:"transparent"},children:(0,b.jsx)("p",{className:"text-center leading-tight",style:{fontFamily:a.fontFamily,fontSize:`${Math.max(10,a.fontSize*(f?.22:.28))}px`,fontWeight:a.bold?700:400,fontStyle:a.italic?"italic":"normal",textShadow:a.outlineWidth>0?`0 0 ${1.5*a.outlineWidth}px ${a.outlineColor},
                       ${a.outlineWidth}px ${a.outlineWidth}px 0 ${a.outlineColor},
                       -${a.outlineWidth}px -${a.outlineWidth}px 0 ${a.outlineColor},
                       ${a.outlineWidth}px -${a.outlineWidth}px 0 ${a.outlineColor},
                       -${a.outlineWidth}px ${a.outlineWidth}px 0 ${a.outlineColor}`:"none",letterSpacing:"0.02em"},children:l.map((c,d)=>(0,b.jsxs)("span",{style:{color:d===m?a.highlightColor:a.textColor},children:[c," "]},d))})})})]})]}),(0,b.jsxs)("div",{className:(0,g.cn)("space-y-3",f&&"grid grid-cols-2 gap-x-4 gap-y-3 space-y-0"),children:[(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(s.Label,{className:"text-xs",children:"Font"}),(0,b.jsxs)(B.Select,{value:a.fontFamily,onValueChange:a=>j({fontFamily:a}),children:[(0,b.jsx)(B.SelectTrigger,{className:"h-8 text-xs",children:(0,b.jsx)(B.SelectValue,{})}),(0,b.jsx)(B.SelectContent,{children:aZ.map(a=>(0,b.jsx)(B.SelectItem,{value:a,children:(0,b.jsx)("span",{style:{fontFamily:a},children:a})},a))})]})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(s.Label,{className:"text-xs",children:"Size"}),(0,b.jsxs)("span",{className:"text-[10px] text-muted-foreground",children:[a.fontSize,"px"]})]}),(0,b.jsx)(ag.Slider,{value:[a.fontSize],onValueChange:([a])=>j({fontSize:a}),min:24,max:80,step:2,className:"w-full"})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(s.Label,{className:"text-xs",children:"Text Color"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:"color",value:a.textColor,onChange:a=>j({textColor:a.target.value}),className:"opacity-0 absolute inset-0 cursor-pointer"}),(0,b.jsx)("div",{className:"h-6 w-8 rounded border border-border",style:{backgroundColor:a.textColor}})]}),(0,b.jsx)(r.Input,{type:"text",value:a.textColor,onChange:a=>j({textColor:a.target.value}),className:"w-20 h-8 text-xs font-mono"})]})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(s.Label,{className:"text-xs",children:"Highlight"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:"color",value:a.highlightColor,onChange:a=>j({highlightColor:a.target.value}),className:"opacity-0 absolute inset-0 cursor-pointer"}),(0,b.jsx)("div",{className:"h-6 w-8 rounded border border-border",style:{backgroundColor:a.highlightColor}})]}),(0,b.jsx)(r.Input,{type:"text",value:a.highlightColor,onChange:a=>j({highlightColor:a.target.value}),className:"w-20 h-8 text-xs font-mono"})]})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(s.Label,{className:"text-xs",children:"Background"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:"color",value:a.backgroundColor||"#000000",onChange:a=>j({backgroundColor:a.target.value}),className:"opacity-0 absolute inset-0 cursor-pointer"}),(0,b.jsx)("div",{className:"h-6 w-8 rounded border border-border",style:{backgroundColor:a.backgroundColor||"#000000"}})]}),(0,b.jsx)(r.Input,{type:"text",value:a.backgroundColor,onChange:a=>j({backgroundColor:a.target.value}),className:"w-20 h-8 text-xs font-mono"}),(0,b.jsxs)("span",{className:"text-[10px] text-muted-foreground",children:[a.backgroundOpacity,"%"]}),(0,b.jsx)(ag.Slider,{value:[a.backgroundOpacity],onValueChange:([a])=>j({backgroundOpacity:a}),min:10,max:100,step:5,className:"flex-1"})]})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(s.Label,{className:"text-xs",children:"Outline"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:"color",value:a.outlineColor,onChange:a=>j({outlineColor:a.target.value}),className:"opacity-0 absolute inset-0 cursor-pointer"}),(0,b.jsx)("div",{className:"h-6 w-8 rounded border border-border",style:{backgroundColor:a.outlineColor}})]}),(0,b.jsx)(ag.Slider,{value:[a.outlineWidth],onValueChange:([a])=>j({outlineWidth:a}),min:0,max:5,step:1,className:"flex-1"}),(0,b.jsxs)("span",{className:"text-[10px] text-muted-foreground",children:[a.outlineWidth,"px"]})]})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(s.Label,{className:"text-xs",children:"Words per Page"}),(0,b.jsx)("span",{className:"text-[10px] text-muted-foreground",children:a.wordsPerPage})]}),(0,b.jsx)(ag.Slider,{value:[a.wordsPerPage],onValueChange:([a])=>j({wordsPerPage:a}),min:2,max:8,step:1,className:"w-full"})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(s.Label,{className:"text-xs",children:"Position"}),(0,b.jsxs)(B.Select,{value:a.position,onValueChange:a=>{j({position:a,verticalPosition:"top"===a?20:"center"===a?50:70})},children:[(0,b.jsx)(B.SelectTrigger,{className:"h-8 text-xs",children:(0,b.jsx)(B.SelectValue,{})}),(0,b.jsxs)(B.SelectContent,{children:[(0,b.jsx)(B.SelectItem,{value:"bottom",children:"Bottom"}),(0,b.jsx)(B.SelectItem,{value:"center",children:"Center"}),(0,b.jsx)(B.SelectItem,{value:"top",children:"Top"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 pt-1",children:[(0,b.jsx)("span",{className:"text-[10px] text-muted-foreground w-3",children:"Top"}),(0,b.jsx)(ag.Slider,{value:[a.verticalPosition],onValueChange:([a])=>{j({verticalPosition:a,position:a<=33?"top":a<=66?"center":"bottom"}),h&&i(null)},min:0,max:100,step:1,className:"flex-1"}),(0,b.jsx)("span",{className:"text-[10px] text-muted-foreground w-3",children:"Btm"})]}),(0,b.jsx)("div",{className:"text-center",children:(0,b.jsxs)("span",{className:"text-[10px] text-muted-foreground",children:[Math.round(a.verticalPosition),"%"]})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(ac,{checked:a.bold,onCheckedChange:a=>j({bold:a}),className:"scale-75"}),(0,b.jsx)(s.Label,{className:"text-xs font-bold",children:"Bold"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(ac,{checked:a.italic,onCheckedChange:a=>j({italic:a}),className:"scale-75"}),(0,b.jsx)(s.Label,{className:"text-xs italic",children:"Italic"})]})]})]}),h&&(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)(aV,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsxs)("span",{className:"text-[10px] text-muted-foreground",children:["Using preset: ",a_.find(a=>a.id===h)?.name]})]})]})}function a7({settings:a,onChange:c}){return(0,b.jsx)(a6,{settings:a,onChange:c,compact:!0})}function a8({audioSignedUrl:a,imageSignedUrl:c,selectedImageUrl:f,audioUrl:g,script:h,onVideoReady:i}){let j,k,[l,m]=(0,d.useState)("480p"),[n,p]=(0,d.useState)("idle"),[q,r]=(0,d.useState)(null),[x,y]=(0,d.useState)(null),[z,A]=(0,d.useState)(0),C=(0,d.useRef)(!1),[G,H]=(0,d.useState)(!1),[I,J]=(0,d.useState)({...a$}),[K,L]=(0,d.useState)(null);(0,d.useEffect)(()=>{(async()=>{g&&(L(null),L(await E(g)))})()},[g]);let M=(0,d.useCallback)(async b=>{p("transcribing");try{let c=await fetch("/api/talking-head/transcribe-audio",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({audioUrl:a})}),d=await c.json();if(!c.ok||!d.words?.length){console.error("Caption transcription failed:",d.error),w.toast.warning("Could not transcribe audio for captions. Video saved without captions."),p("completed"),i(b);return}p("burning");let e=await fetch("/api/talking-head/add-captions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({videoUrl:b,words:d.words,customSettings:I})}),f=await e.json();if(!e.ok){console.error("Caption burn-in failed:",f.error),w.toast.warning("Could not add captions. Video saved without captions."),p("completed"),i(b);return}p("completed"),w.toast.success("Video generated with captions!"),i(b,f.signedUrl,f.assetId)}catch(a){console.error("Caption error:",a),w.toast.warning("Caption processing failed. Video saved without captions."),p("completed"),i(b)}},[a,I,i]),N=(0,d.useCallback)(async a=>{C.current=!0;let b=0;for(;C.current&&b<100;){A(++b);try{let b=await fetch(`/api/talking-head/queue-status?queueId=${encodeURIComponent(a)}`),c=await b.json();if(!b.ok){p("failed"),y(c.error||"Failed to check status"),C.current=!1;return}if("completed"===c.status&&c.taskId){C.current=!1,r(c.taskId),await O(c.taskId);return}if("failed"===c.status){p("failed"),y(c.error||"Video generation failed"),C.current=!1;return}await new Promise(a=>setTimeout(a,3e3))}catch{p("failed"),y("Network error while checking status"),C.current=!1;return}}C.current&&(p("failed"),y("Video generation timed out. Please try again."),C.current=!1)},[G,i,M]),O=(0,d.useCallback)(async a=>{C.current=!0;let b=0;for(;C.current&&b<100;){A(++b);try{let b=await fetch(`/api/talking-head/status?taskId=${encodeURIComponent(a)}`),c=await b.json();if(!b.ok){p("failed"),y(c.error||"Failed to check status"),C.current=!1;return}if("completed"===c.status&&c.videoUrl){C.current=!1,G?M(c.videoUrl):(p("completed"),w.toast.success("Video generated successfully!"),i(c.videoUrl));return}if("failed"===c.status){p("failed"),y(c.error||"Video generation failed"),C.current=!1;return}await new Promise(a=>setTimeout(a,3e3))}catch{p("failed"),y("Network error while checking status"),C.current=!1;return}}C.current&&(p("failed"),y("Video generation timed out. Please try again."),C.current=!1)},[G,i,M]);(0,d.useEffect)(()=>()=>{C.current=!1},[]);let P=async()=>{p("submitting"),y(null),A(0);try{let b=await fetch("/api/talking-head/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({audioSignedUrl:a,imageSignedUrl:c,resolution:l})}),d=await b.json();if(!b.ok){p("failed"),y(d.error||"Failed to queue video generation");return}p("polling"),w.toast.info("Job queued. You'll be notified when it starts..."),N(d.queueItem.id)}catch{p("failed"),y("Failed to queue video generation")}},Q=null!==K?F(K,l).cost:null,R="transcribing"===n?85:"burning"===n?92:Math.min(z/100*100,80);return(0,b.jsxs)("div",{className:"max-w-xl mx-auto space-y-4",children:[(0,b.jsxs)("div",{className:"text-center space-y-2",children:[(0,b.jsx)("div",{className:"mx-auto w-12 h-12 rounded-full bg-accent-blue/10 flex items-center justify-center",children:(0,b.jsx)(o.Video,{className:"h-6 w-6 text-accent-blue"})}),(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Generate Talking Head Video"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Review your selections and generate the lip-synced video."})]}),(0,b.jsx)("div",{className:"rounded-lg bg-card p-4 space-y-3",children:(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("img",{src:f,alt:"Selected portrait",className:"h-20 w-20 rounded-md object-cover border"}),(0,b.jsxs)("div",{className:"flex-1 space-y-1.5",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs font-medium mb-1",children:"Audio"}),(0,b.jsx)("audio",{controls:!0,src:g,className:"w-full h-8"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs font-medium",children:"Script"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-2",children:h})]})]})]})}),"idle"===n&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{children:"Resolution"}),(0,b.jsxs)(B.Select,{value:l,onValueChange:m,children:[(0,b.jsx)(B.SelectTrigger,{className:"w-full",children:(0,b.jsx)(B.SelectValue,{})}),(0,b.jsxs)(B.SelectContent,{children:[(0,b.jsx)(B.SelectItem,{value:"480p",children:"480p — $0.03/sec (Recommended)"}),(0,b.jsx)(B.SelectItem,{value:"720p",children:"720p — $0.06/sec"})]})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Minimum charge: $0.15. Max duration: 10 minutes."})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(af,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)(s.Label,{children:"Add Captions"})]}),(0,b.jsx)(ac,{checked:G,onCheckedChange:H})]}),G&&(0,b.jsx)(a7,{settings:I,onChange:J})]}),(0,b.jsxs)("div",{className:"rounded-lg bg-card p-4 space-y-2",children:[(0,b.jsx)("p",{className:"text-xs font-medium",children:"Estimated Cost"}),null===K?(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Estimating..."}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex items-end gap-1",children:[(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"Duration: "}),(0,b.jsx)("span",{className:"text-xs font-medium",children:(j=Math.floor(K/60),k=Math.floor(K%60),`${j}:${k.toString().padStart(2,"0")}`)})]}),(0,b.jsxs)("div",{className:"flex items-center justify-center py-2 bg-muted/50 rounded",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground mr-2",children:"Total:"}),(0,b.jsxs)("span",{className:"text-2xl font-semibold text-green-600",children:["$",F(K,l).cost.toFixed(2)]})]}),K<5&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"⚠️ Minimum charge: $0.15 applies"})]})]})]}),("submitting"===n||"polling"===n||"transcribing"===n||"burning"===n)&&(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(u.Loader2,{className:"h-4 w-4 animate-spin text-accent-blue"}),(0,b.jsxs)("span",{className:"text-sm font-medium",children:["submitting"===n&&"Submitting...","polling"===n&&"Generating video...","transcribing"===n&&"Transcribing audio for captions...","burning"===n&&"Burning captions into video..."]}),"polling"===n&&(0,b.jsxs)("span",{className:"text-xs text-muted-foreground ml-auto",children:[Math.round(3*z),"s elapsed"]})]}),(0,b.jsx)(ad.Progress,{value:R,className:"h-2"}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground text-center",children:["polling"===n&&z<20&&"Processing your video. This usually takes 1-3 minutes...","polling"===n&&z>=20&&z<60&&"Still processing. Longer scripts take more time...","polling"===n&&z>=60&&"Almost there. Please wait...","transcribing"===n&&"Detecting word-level timing from your TTS audio...","burning"===n&&"Rendering video with styled captions (this may take a minute)..."]})]}),"completed"===n&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(D.CheckCircle2,{className:"h-4 w-4 text-green-500"}),(0,b.jsxs)("span",{className:"text-sm font-medium",children:["Video generated",G?" with captions":"","!"]})]}),x&&(0,b.jsxs)(t.Alert,{variant:"destructive",children:[(0,b.jsx)(v.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(t.AlertDescription,{children:x})]}),"idle"===n&&(0,b.jsxs)(e.Button,{onClick:P,className:"w-full",size:"lg",children:[(0,b.jsx)(o.Video,{className:"h-4 w-4 mr-2"}),"Generate Video",G?" with Captions":"",null!==Q&&` — Est. $${Q.toFixed(2)}`]}),"failed"===n&&(0,b.jsxs)(e.Button,{onClick:()=>{p("idle"),y(null),r(null),A(0)},variant:"outline",className:"w-full",children:[(0,b.jsx)(ae.RefreshCw,{className:"h-4 w-4 mr-2"}),"Try Again"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground text-center",children:"Powered by WaveSpeed InfiniteTalk."})]})}var a9=a.i(84505);function ba({videoUrl:a,videoAssetId:c,onSaved:f,onStartNew:g}){let[h,i]=(0,d.useState)(!1),[j,k]=(0,d.useState)(null),l=async()=>{i(!0),k(null);try{let b=await fetch("/api/talking-head/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({videoUrl:a})}),c=await b.json();if(!b.ok)return void k(c.error||"Failed to save video");w.toast.success("Video saved to asset library!"),f(c.assetId)}catch{k("Failed to save video")}finally{i(!1)}};return(0,b.jsxs)("div",{className:"max-w-xl mx-auto space-y-4",children:[(0,b.jsxs)("div",{className:"text-center space-y-2",children:[(0,b.jsx)("div",{className:"mx-auto w-12 h-12 rounded-full bg-accent-blue/10 flex items-center justify-center",children:(0,b.jsx)(p.Play,{className:"h-6 w-6 text-accent-blue"})}),(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Video Ready"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Preview your talking head video below. Download or save it to your asset library."})]}),(0,b.jsx)("div",{className:"rounded-lg overflow-hidden bg-black",children:(0,b.jsx)("video",{controls:!0,src:a,className:"w-full max-h-[500px]",autoPlay:!1,preload:"metadata"})}),j&&(0,b.jsxs)(t.Alert,{variant:"destructive",children:[(0,b.jsx)(v.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(t.AlertDescription,{children:j})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(e.Button,{variant:"outline",onClick:()=>{let b=document.createElement("a");b.href=a,b.download=`talking-head-${Date.now()}.mp4`,b.target="_blank",b.click()},className:"flex-1",children:[(0,b.jsx)(a9.Download,{className:"h-4 w-4 mr-2"}),"Download"]}),c?(0,b.jsxs)(e.Button,{disabled:!0,className:"flex-1",children:[(0,b.jsx)(D.CheckCircle2,{className:"h-4 w-4 mr-2"}),"Saved to Library"]}):(0,b.jsx)(e.Button,{onClick:l,disabled:h,className:"flex-1",children:h?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(u.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(aY.Save,{className:"h-4 w-4 mr-2"}),"Save to Library"]})})]}),(0,b.jsxs)(e.Button,{variant:"outline",onClick:g,className:"w-full",children:[(0,b.jsx)(ae.RefreshCw,{className:"h-4 w-4 mr-2"}),"Start New Video"]})]})}let bb=[{label:"Video URL",icon:q.Link2},{label:"Transcript",icon:k.FileText},{label:"Edit Script",icon:l},{label:"Voice",icon:m.Mic},{label:"Image",icon:n.ImageIcon},{label:"Generate",icon:o.Video},{label:"Preview",icon:p.Play}];function bc({aiModels:a,prefillVideoUrl:c}){let[h,k]=(0,d.useState)(1),[l,m]=(0,d.useState)(c||""),[n,o]=(0,d.useState)(""),[p,q]=(0,d.useState)(""),[r,s]=(0,d.useState)(null),[t,u]=(0,d.useState)(null),[v,w]=(0,d.useState)(null),[z,B]=(0,d.useState)(null),[C,D]=(0,d.useState)(null),[E,F]=(0,d.useState)(null),[H,I]=(0,d.useState)(null),[J,K]=(0,d.useState)(null),[M,N]=(0,d.useState)(null),O=(0,d.useCallback)(()=>{switch(h){case 1:return n.length>0;case 2:case 3:return p.length>0;case 4:return null!==t&&null!==v;case 5:return null!==z;case 6:return null!==E;case 7:return!0;default:return!1}},[h,n,p,t,v,z,E]),P=(0,d.useCallback)(()=>{h<7&&O()&&k(a=>a+1)},[h,O]),Q=(0,d.useCallback)(()=>{h>1&&k(a=>a-1)},[h]),R=(0,d.useCallback)(()=>{k(1),m(""),o(""),q(""),s(null),u(null),w(null),B(null),D(null),F(null),I(null),K(null),N(null)},[]);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center gap-1 overflow-x-auto pb-2",children:bb.map((a,c)=>{let d=c+1,e=h===d,i=h>d,j=a.icon;return(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[c>0&&(0,b.jsx)("div",{className:(0,g.cn)("h-px w-4 sm:w-8",i?"bg-accent-blue":"bg-border")}),(0,b.jsxs)("button",{type:"button",onClick:()=>{i&&k(d)},disabled:!i&&!e,className:(0,g.cn)("flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-medium transition-colors whitespace-nowrap",e&&"bg-accent-blue text-white",i&&"bg-accent-blue/10 text-accent-blue hover:bg-accent-blue/20 cursor-pointer",!e&&!i&&"bg-muted text-muted-foreground cursor-default"),children:[(0,b.jsx)(j,{className:"h-3 w-3"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:a.label}),(0,b.jsx)(f.Badge,{variant:e?"secondary":"outline",className:"h-4 w-4 p-0 flex items-center justify-center text-[10px]",children:d})]})]},d)})}),(0,b.jsxs)("div",{className:"min-h-[400px]",children:[1===h&&(0,b.jsx)(x,{videoUrl:l,onVideoUrlChange:m,onTranscriptReady:a=>{o(a),q(a),k(2)}}),2===h&&(0,b.jsx)(y,{transcript:n,onUseAsScript:()=>{q(n),k(3)}}),3===h&&(0,b.jsx)(A,{script:p,onScriptChange:q}),4===h&&(0,b.jsx)(G,{script:p,aiModels:a,selectedModel:r,onModelChange:s,audioUrl:t,onAudioGenerated:(a,b)=>{u(a),w(b)}}),5===h&&(0,b.jsx)(L,{selectedModel:r,selectedImageId:C,onImageSelect:(a,b)=>{D(a),B(b)}}),6===h&&(0,b.jsx)(a8,{audioSignedUrl:v,imageSignedUrl:z,selectedImageUrl:z,audioUrl:t,script:p,onVideoReady:(a,b,c)=>{F(a),b&&I(b),c&&K(c),k(7)}}),7===h&&(0,b.jsx)(ba,{videoUrl:H||E,videoAssetId:J||M,onSaved:a=>N(a),onStartNew:R})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between border-t pt-4",children:[(0,b.jsxs)(e.Button,{variant:"outline",onClick:Q,disabled:1===h,children:[(0,b.jsx)(i,{className:"h-4 w-4 mr-2"}),"Back"]}),h<7&&6!==h&&(0,b.jsxs)(e.Button,{onClick:P,disabled:!O(),children:["Next",(0,b.jsx)(j.ArrowRight,{className:"h-4 w-4 ml-2"})]})]})]})}var bd=a.i(15618),be=a.i(81560),bf=a.i(97063),bg=a.i(14574),bh=a.i(95445);function bi({step:a,title:c,description:d,children:e}){return(0,b.jsxs)("div",{className:"rounded-lg border border-border bg-card p-5 space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-sm font-semibold",children:a}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("h3",{className:"text-base font-semibold",children:c}),(0,b.jsx)(bf.Info,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-0.5",children:d})]})]}),e]})}function bj({aiModels:a}){let c=a.filter(a=>a.voice_id&&a.voice_id.trim()),[h,i]=(0,d.useState)(""),[j,k]=(0,d.useState)("480p"),[l,p]=(0,d.useState)(!1),[q,x]=(0,d.useState)({...a$}),[y,A]=(0,d.useState)([{id:crypto.randomUUID(),script:"",imageId:null,imageUrl:null,status:"pending"}]),[C,E]=(0,d.useState)(!1),F=(0,d.useRef)(new Map),[G,I]=(0,d.useState)(null),[L,M]=(0,d.useState)([]),[N,O]=(0,d.useState)(0),[P,Q]=(0,d.useState)(!1),[R,S]=(0,d.useState)(""),[T,U]=(0,d.useState)(!1),[V,W]=(0,d.useState)(null),X=(0,d.useRef)(null),[Y,Z]=(0,d.useState)([]),[$,_]=(0,d.useState)(!1),[aa,ab]=(0,d.useState)(!1),ae=(0,d.useRef)(null),[ag,ah]=(0,d.useState)(null),[ai,aj]=(0,d.useState)({...a$}),[ak,al]=(0,d.useState)(!1),am=c.find(a=>a.id===h)||null;(0,d.useEffect)(()=>()=>{F.current.forEach((a,b)=>F.current.set(b,!1))},[]);let an=(a,b)=>{A(c=>c.map(c=>c.id===a?{...c,...b}:c))},ao=(0,d.useCallback)(async a=>{Q(!0);let b=a?L.length:0,c=await (0,K.getAssetsAction)({file_type:"image",search:R||void 0,sort_by:"created_at",sort_order:"desc",limit:30,offset:b});a?M(a=>[...a,...c.assets]):M(c.assets),O(c.total),Q(!1)},[R,L.length]);(0,d.useEffect)(()=>{G&&(S(""),ao(!1))},[G]);let ap=a=>{G&&(an(G,{imageId:a.id,imageUrl:a.signed_url}),I(null))},aq=async(a,b)=>{if(!a||!a.type.startsWith("image/"))return null;if(a.size>0x3200000)return w.toast.error("File exceeds 50MB size limit"),null;U(!0);try{let c=(0,bh.createClient)(),{data:{user:d}}=await c.auth.getUser();if(!d)return w.toast.error("Not authenticated"),null;let e=crypto.randomUUID(),f=a.name.replace(/[^a-zA-Z0-9._-]/g,"_"),g=`${d.id}/image/${e}_${f}`,{error:h}=await c.storage.from("assets").upload(g,a,{contentType:a.type,upsert:!1});if(h)return w.toast.error(`Upload failed: ${h.message}`),null;let{data:i,error:j}=await c.from("assets").insert({user_id:d.id,filename:a.name,file_path:g,file_type:"image",mime_type:a.type,file_size:a.size,tags:["talking-head","portrait"],metadata:{}}).select("id").single();if(j)return await c.storage.from("assets").remove([g]),w.toast.error(`Database error: ${j.message}`),null;let{data:k}=await c.storage.from("assets").createSignedUrl(g,3600),l={id:i.id,url:k?.signedUrl||""},m=b||G;return m&&(an(m,{imageId:l.id,imageUrl:l.url}),b||I(null)),l}catch{return w.toast.error("Failed to upload image"),null}finally{U(!1),X.current&&(X.current.value="")}},ar=async a=>{let b=a.target.files?.[0];b&&await aq(b)},as=()=>{W(null)},at=async(a,b)=>{if(a.preventDefault(),a.stopPropagation(),W(null),C)return;let c=a.dataTransfer.files;if(!c||0===c.length)return;let d=c[0];d.type.startsWith("image/")?await aq(d,b):w.toast.error("Only image files are supported")},au=async a=>{_(!0);let b=(0,bh.createClient)(),{data:{user:c}}=await b.auth.getUser();if(!c){w.toast.error("Not authenticated"),_(!1);return}let d=[];for(let b=0;b<a.length;b++){let c=a[b];if(c.type.startsWith("image/")){if(c.size>0x3200000){w.toast.error(`File "${c.name}" exceeds 50MB limit`);continue}d.push(c)}}if(0===d.length)return void _(!1);let e=[],f=0;for(let a=0;a<d.length;a+=3){let g=d.slice(a,a+3);for(let a of(await Promise.all(g.map(async a=>{try{let d=crypto.randomUUID(),e=a.name.replace(/[^a-zA-Z0-9._-]/g,"_"),f=`${c.id}/image/${d}_${e}`,{error:g}=await b.storage.from("assets").upload(f,a,{contentType:a.type,upsert:!1});if(g)return null;let{data:h,error:i}=await b.from("assets").insert({user_id:c.id,filename:a.name,file_path:f,file_type:"image",mime_type:a.type,file_size:a.size,tags:["talking-head","portrait"],metadata:{}}).select("id").single();if(i)return await b.storage.from("assets").remove([f]),null;let{data:j}=await b.storage.from("assets").createSignedUrl(f,3600);if(!j?.signedUrl)return null;return{id:h.id,url:j.signedUrl}}catch{return null}}))))a?e.push(a):f++}e.length>0?(Z(a=>[...a,...e]),w.toast.success(`${e.length} image${1===e.length?"":"s"} uploaded to pool`),f>0&&w.toast.error(`${f} image${1===f?"":"s"} failed to upload`)):w.toast.error("Failed to upload images"),_(!1)},av=async a=>{let b=a.target.files;b&&b.length>0&&await au(b),ae.current&&(ae.current.value="")},aw=async a=>{if(a.preventDefault(),a.stopPropagation(),ab(!1),C)return;let b=a.dataTransfer.files;if(!b||0===b.length)return;let c=Array.from(b).filter(a=>a.type.startsWith("image/"));0===c.length?w.toast.error("Only image files are supported"):await au(c)},ax=(0,d.useCallback)(async(a,b,c,d)=>{an(a,{status:"captioning"});try{let e=await fetch("/api/talking-head/transcribe-audio",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({audioUrl:c})}),f=await e.json();if(!e.ok||!f.words?.length){let c=f.error||"No word timestamps returned";console.error("Caption transcription failed:",c),w.toast.warning(`Captions skipped: transcription failed — ${c}`),an(a,{status:"completed",videoUrl:b});return}let g=await fetch("/api/talking-head/add-captions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({videoUrl:b,words:f.words,customSettings:d||q})}),h=await g.json();if(!g.ok){let c=h.error||"Unknown error";console.error("Caption burn-in failed:",c),w.toast.warning(`Captions skipped: burn-in failed — ${c}`),an(a,{status:"completed",videoUrl:b,words:f.words});return}an(a,{status:"completed",captionedVideoUrl:h.signedUrl,videoAssetId:h.assetId,words:f.words})}catch(d){let c=d instanceof Error?d.message:"Unknown error";console.error("Caption error:",d),w.toast.warning(`Captions skipped: ${c}`),an(a,{status:"completed",videoUrl:b})}},[q]),ay=async()=>{if(!ag)return;let a=y.find(a=>a.id===ag);if(!a||!a.videoUrl||!a.words||!a.words.length){w.toast.error("Cannot re-caption: missing video or word timestamps"),ah(null);return}al(!0);try{let b=await fetch("/api/talking-head/add-captions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({videoUrl:a.videoUrl,words:a.words,customSettings:ai})}),c=await b.json();if(!b.ok){w.toast.error(c.error||"Failed to re-caption video"),al(!1);return}an(a.id,{captionedVideoUrl:c.signedUrl,videoAssetId:c.assetId}),w.toast.success("Captions updated successfully"),ah(null)}catch(a){console.error("Re-caption error:",a),w.toast.error("Failed to re-caption video")}finally{al(!1)}},az=(0,d.useCallback)(async(a,b,c,d)=>{F.current.set(a,!0);let e=0,f=0;for(;F.current.get(a)&&e<200;){an(a,{pollCount:++e});try{let e=await fetch(`/api/talking-head/status?taskId=${encodeURIComponent(b)}`),g=await e.json();if("completed"===g.status&&g.videoUrl){F.current.set(a,!1),c?ax(a,g.videoUrl,d):an(a,{status:"completed",videoUrl:g.videoUrl});return}if("failed"===g.status){F.current.set(a,!1),an(a,{status:"failed",error:g.error||"Video generation failed"});return}f=0,await new Promise(a=>setTimeout(a,5e3))}catch(b){if(f++,console.warn(`Poll error for job ${a} (attempt ${e}):`,b),f>=3){F.current.set(a,!1),an(a,{status:"failed",error:"Network error after multiple retries"});return}await new Promise(a=>setTimeout(a,5e3))}}F.current.get(a)&&(F.current.set(a,!1),an(a,{status:"failed",error:`Timed out after ${e} polls (${Math.round(5e3*e/1e3)}s)`}))},[ax]),aA=(0,d.useCallback)(async(a,b)=>{an(a.id,{status:"generating_voice"});try{let c=await fetch("/api/tts/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:a.script,voice_id:b.voice_id,settings:b.voice_settings})});if(!c.ok){let b=await c.json().catch(()=>({error:"TTS failed"}));an(a.id,{status:"failed",error:b.error||"TTS failed"});return}let d=await c.blob(),e=URL.createObjectURL(d);an(a.id,{audioUrl:e}),an(a.id,{status:"uploading_audio"});let f=new FormData;f.append("file",d,"talking-head-audio.mp3");let g=await fetch("/api/talking-head/upload-audio",{method:"POST",body:f}),h=await g.json();if(!g.ok)return void an(a.id,{status:"failed",error:h.error||"Audio upload failed"});an(a.id,{audioSignedUrl:h.signedUrl}),an(a.id,{status:"submitting"});let i=await fetch("/api/talking-head/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({audioSignedUrl:h.signedUrl,imageSignedUrl:a.imageUrl,resolution:j})}),k=await i.json();if(!i.ok)return void an(a.id,{status:"failed",error:k.error||"Submit failed"});an(a.id,{status:"polling",taskId:k.taskId,pollCount:0}),az(a.id,k.taskId,l,h.signedUrl)}catch(b){an(a.id,{status:"failed",error:b instanceof Error?b.message:"Processing failed"})}},[j,l,az]),aB=async()=>{if(!am)return void w.toast.error("Select an AI model first");let a=y.filter(a=>"pending"===a.status&&a.script.trim()&&!a.imageId&&!a.imageUrl);if(a.length>0){if(Y.length<a.length)return void w.toast.error(`Not enough images in pool. Need ${a.length} image${1===a.length?"":"s"}, have ${Y.length}. Add more images or select manually.`);let{assignedCount:b,assignedJobIds:c}=(()=>{let a=y.filter(a=>"pending"===a.status&&a.script.trim()&&!a.imageId&&!a.imageUrl);if(0===a.length||0===Y.length)return{assignedCount:0,assignedJobIds:[]};let b=[...Y].sort(()=>Math.random()-.5),c=Math.min(a.length,b.length),d=[],e=[];for(let f=0;f<c;f++){let c=a[f].id;d.push({id:c,imageId:b[f].id,imageUrl:b[f].url}),e.push(c)}return A(a=>a.map(a=>{let b=d.find(b=>b.id===a.id);return b?{...a,imageId:b.imageId,imageUrl:b.imageUrl}:a})),{assignedCount:c,assignedJobIds:e}})();if(0===b)return void w.toast.error("Failed to assign images from pool");await new Promise(a=>setTimeout(a,50));let d=y.filter(a=>a.script.trim()&&a.imageId&&a.imageUrl&&"pending"===a.status);if(0===d.length)return void w.toast.error("No valid jobs to process. Each needs a script and image.");for(let a of(E(!0),w.toast.info(`Starting ${d.length} video generation${d.length>1?"s":""}...`),d))aA(a,am)}else{let a=y.filter(a=>a.script.trim()&&a.imageId&&a.imageUrl&&"pending"===a.status);if(0===a.length)return void w.toast.error("No valid jobs to process. Each needs a script and image.");for(let b of(E(!0),w.toast.info(`Starting ${a.length} video generation${a.length>1?"s":""}...`),a))aA(b,am)}},aC=async(a,b)=>{try{let c=await fetch("/api/talking-head/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({videoUrl:b})}),d=await c.json();c.ok?(an(a,{videoAssetId:d.assetId}),w.toast.success("Video saved to library!")):w.toast.error(d.error||"Failed to save")}catch{w.toast.error("Failed to save video")}},aD=y.filter(a=>"completed"===a.status).length,aE=y.filter(a=>"failed"===a.status).length,aF=y.filter(a=>"generating_voice"===a.status||"uploading_audio"===a.status||"submitting"===a.status||"polling"===a.status||"captioning"===a.status).length,aG=C&&0===aF,aH=y.filter(a=>"pending"===a.status&&a.script.trim()&&!a.imageId&&!a.imageUrl).length,aI=!C&&h&&y.some(a=>a.script.trim()&&(a.imageId||Y.length>=aH));return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(bi,{step:1,title:"Select AI Model & Resolution",description:"Choose which AI model voice to use for narration and the output video resolution. Models need voice settings configured in the AI Models page.",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{children:"AI Model (Voice)"}),0===c.length?(0,b.jsxs)(t.Alert,{children:[(0,b.jsx)(v.AlertCircle,{className:"h-4 w-4"}),(0,b.jsxs)(t.AlertDescription,{children:["No AI models with voice configured. ",(0,b.jsx)("a",{href:"/dashboard/models",className:"underline font-medium",children:"Add voice settings"})]})]}):(0,b.jsxs)(B.Select,{value:h,onValueChange:i,children:[(0,b.jsx)(B.SelectTrigger,{children:(0,b.jsx)(B.SelectValue,{placeholder:"Select AI model..."})}),(0,b.jsx)(B.SelectContent,{children:c.map(a=>(0,b.jsx)(B.SelectItem,{value:a.id,children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[a.reference_images.length>0?(0,b.jsx)("img",{src:a.reference_images[0].signed_url,alt:"",className:"h-5 w-5 rounded-sm object-cover"}):(0,b.jsx)(m.Mic,{className:"h-3.5 w-3.5 text-muted-foreground"}),a.name]})},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{children:"Resolution"}),(0,b.jsxs)(B.Select,{value:j,onValueChange:k,children:[(0,b.jsx)(B.SelectTrigger,{children:(0,b.jsx)(B.SelectValue,{})}),(0,b.jsxs)(B.SelectContent,{children:[(0,b.jsx)(B.SelectItem,{value:"480p",children:"480p — $0.03/sec"}),(0,b.jsx)(B.SelectItem,{value:"720p",children:"720p — $0.06/sec"})]})]})]})]})}),(0,b.jsx)(bi,{step:2,title:"Captions (Optional)",description:"Add auto-synced captions to your videos. Choose from TikTok-style presets or customize the look.",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(af,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)(s.Label,{children:"Add Captions"})]}),(0,b.jsx)(ac,{checked:l,onCheckedChange:p,disabled:C})]}),l&&!C&&(0,b.jsx)(a7,{settings:q,onChange:x})]})}),(0,b.jsx)(bi,{step:3,title:"Upload Images",description:"Upload portrait images for your videos. Images are randomly assigned to scripts that don't have a manually selected image.",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(s.Label,{className:"text-base",children:"Bulk Image Pool"}),Y.length>0&&(0,b.jsx)("button",{type:"button",onClick:()=>{Z([])},className:"text-xs text-muted-foreground hover:text-destructive transition-colors",children:"Clear All"})]}),(0,b.jsxs)("div",{onDragOver:a=>{a.preventDefault(),a.stopPropagation(),C||ab(!0)},onDragLeave:()=>{ab(!1)},onDrop:aw,className:(0,g.cn)("border-2 border-dashed rounded-lg p-4 transition-all",aa?"border-accent-blue bg-accent-blue/5":"hover:border-accent-blue/50",C?"opacity-50 pointer-events-none":""),children:[(0,b.jsx)("input",{ref:ae,type:"file",accept:"image/*",multiple:!0,onChange:av,className:"hidden"}),0===Y.length?(0,b.jsx)("div",{className:"flex flex-col items-center justify-center gap-2 text-muted-foreground",children:$?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(u.Loader2,{className:"h-8 w-8 animate-spin"}),(0,b.jsx)("p",{className:"text-sm",children:"Uploading images..."})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(J.Upload,{className:"h-8 w-8"}),(0,b.jsx)("p",{className:"text-sm",children:"Drop images here or click to browse"})]})}):(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[Y.length," image",1===Y.length?"":"s"," in pool (randomly assigned to videos without images)"]}),(0,b.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-1",children:Y.map(a=>(0,b.jsxs)("div",{className:"relative group flex-shrink-0",children:[(0,b.jsx)("img",{src:a.url,alt:"",className:"h-16 w-16 rounded-md object-cover border"}),(0,b.jsx)("button",{type:"button",onClick:()=>{var b;return b=a.id,void Z(a=>a.filter(a=>a.id!==b))},className:"absolute -top-1 -right-1 h-5 w-5 rounded-full bg-destructive text-destructive-foreground flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,b.jsx)(aX.X,{className:"h-3 w-3"})})]},a.id))}),(0,b.jsxs)("div",{onClick:()=>ae.current?.click(),className:"border border-dashed rounded-md px-3 py-1 text-xs text-muted-foreground hover:text-accent-blue cursor-pointer inline-flex items-center gap-1 w-fit",children:[(0,b.jsx)(bd.Plus,{className:"h-3 w-3"})," Add more"]})]})]})]})}),(0,b.jsx)(bi,{step:4,title:"Add Scripts",description:"Add one or more scripts. Each script becomes a separate video. You can manually assign images or let the pool handle it.",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(s.Label,{className:"text-base",children:["Videos (",y.length,")"]}),(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",onClick:()=>{A(a=>[...a,{id:crypto.randomUUID(),script:"",imageId:null,imageUrl:null,status:"pending"}])},disabled:C,children:[(0,b.jsx)(bd.Plus,{className:"h-4 w-4 mr-1.5"}),"Add Video"]})]}),y.map((a,c)=>(0,b.jsxs)("div",{className:(0,g.cn)("rounded-lg p-4 space-y-3","completed"===a.status&&"border border-green-500 bg-green-500/5","failed"===a.status&&"border border-destructive bg-destructive/5"),children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("span",{className:"text-sm font-medium",children:["Video ",c+1]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(bk,{status:a.status,pollCount:a.pollCount}),!C&&y.length>1&&(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>{var b;return b=a.id,void(!(y.length<=1)&&(F.current.set(b,!1),A(a=>a.filter(a=>a.id!==b))))},className:"h-7 w-7 p-0",children:(0,b.jsx)(be.Trash2,{className:"h-3.5 w-3.5"})})]})]}),"pending"===a.status&&(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-[1fr_auto] gap-3",children:[(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(s.Label,{className:"text-xs",children:"Script"}),(0,b.jsx)(z.Textarea,{value:a.script,onChange:b=>an(a.id,{script:b.target.value}),placeholder:"Paste the script for this video...",rows:4,className:"resize-y text-sm",disabled:C}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:[a.script.trim().split(/\s+/).filter(Boolean).length," words"]})]}),(0,b.jsxs)("div",{className:"space-y-1.5",onDragOver:b=>{var c;return c=a.id,void(b.preventDefault(),b.stopPropagation(),!C&&W(c))},onDragLeave:as,onDrop:b=>at(b,a.id),children:[(0,b.jsx)(s.Label,{className:"text-xs",children:"Portrait"}),a.imageUrl?(0,b.jsxs)("div",{className:"relative group",children:[(0,b.jsx)("img",{src:a.imageUrl,alt:"Selected",className:(0,g.cn)("h-[106px] w-[106px] rounded-md object-cover border cursor-pointer",V===a.id?"ring-2 ring-accent-blue ring-offset-2":""),onClick:()=>!C&&I(a.id)}),!C&&(0,b.jsx)("button",{type:"button",onClick:()=>an(a.id,{imageId:null,imageUrl:null}),className:"absolute -top-1.5 -right-1.5 h-5 w-5 rounded-full bg-destructive text-destructive-foreground flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,b.jsx)(aX.X,{className:"h-3 w-3"})})]}):(0,b.jsxs)("button",{type:"button",onClick:()=>I(a.id),disabled:C,className:(0,g.cn)("h-[106px] w-[106px] rounded-md border-2 border-dashed flex flex-col items-center justify-center gap-1 text-muted-foreground transition-colors",V===a.id?"border-accent-blue bg-accent-blue/10":"hover:border-accent-blue/50 hover:text-accent-blue"),children:[(0,b.jsx)(n.ImageIcon,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"text-[10px]",children:V===a.id?"Drop image":"Select"})]})]})]}),"pending"!==a.status&&"completed"!==a.status&&"failed"!==a.status&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(u.Loader2,{className:"h-3.5 w-3.5 animate-spin text-accent-blue"}),(0,b.jsxs)("span",{className:"text-xs",children:["generating_voice"===a.status&&"Generating voice...","uploading_audio"===a.status&&"Uploading audio...","submitting"===a.status&&"Submitting video job...","polling"===a.status&&`Generating video... ${Math.round(3*(a.pollCount||0))}s`,"captioning"===a.status&&"Adding captions..."]})]}),"polling"===a.status&&(0,b.jsx)(ad.Progress,{value:Math.min((a.pollCount||0)/200*100,95),className:"h-1.5"})]}),"failed"===a.status&&a.error&&(0,b.jsx)("p",{className:"text-xs text-destructive",children:a.error}),"completed"===a.status&&(a.captionedVideoUrl||a.videoUrl)&&(0,b.jsxs)("div",{className:"space-y-2",children:[a.captionedVideoUrl&&(0,b.jsxs)(f.Badge,{variant:"secondary",className:"gap-1 text-xs mb-1",children:[(0,b.jsx)(af,{className:"h-3 w-3"}),"Captioned"]}),(0,b.jsx)("video",{controls:!0,src:a.captionedVideoUrl||a.videoUrl,className:"w-full max-h-[200px] rounded-md bg-black",preload:"metadata"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",onClick:()=>{let b=document.createElement("a");b.href=a.captionedVideoUrl||a.videoUrl,b.download=`talking-head-${c+1}.mp4`,b.target="_blank",b.click()},children:[(0,b.jsx)(a9.Download,{className:"h-3.5 w-3.5 mr-1"}),"Download"]}),a.words&&a.words.length>0&&a.videoUrl&&(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",onClick:()=>{ah(a.id),aj({...a$})},children:[(0,b.jsx)(af,{className:"h-3.5 w-3.5 mr-1"}),"Re-caption"]}),a.videoAssetId?(0,b.jsxs)(f.Badge,{variant:"secondary",className:"gap-1",children:[(0,b.jsx)(D.CheckCircle2,{className:"h-3 w-3"}),"Saved"]}):(0,b.jsxs)(e.Button,{size:"sm",onClick:()=>aC(a.id,a.captionedVideoUrl||a.videoUrl),children:[(0,b.jsx)(aY.Save,{className:"h-3.5 w-3.5 mr-1"}),"Save to Library"]})]})]})]},a.id))]})}),C&&(0,b.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[aF>0&&(0,b.jsxs)(f.Badge,{variant:"secondary",children:[(0,b.jsx)(u.Loader2,{className:"h-3 w-3 mr-1 animate-spin"}),aF," processing"]}),aD>0&&(0,b.jsxs)(f.Badge,{variant:"secondary",className:"text-green-600",children:[(0,b.jsx)(D.CheckCircle2,{className:"h-3 w-3 mr-1"}),aD," completed"]}),aE>0&&(0,b.jsxs)(f.Badge,{variant:"destructive",children:[(0,b.jsx)(v.AlertCircle,{className:"h-3 w-3 mr-1"}),aE," failed"]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(e.Button,{onClick:aB,disabled:!aI,size:"lg",className:"flex-1",children:[(0,b.jsx)(o.Video,{className:"h-4 w-4 mr-2"}),C?aG?"All Done":`Processing ${aF} video${1!==aF?"s":""}...`:`Generate ${y.filter(a=>a.script.trim()&&(a.imageId||Y.length)).length} Video${aH>0?` (${aH} from pool)`:""}`]}),aG&&(0,b.jsx)(e.Button,{variant:"outline",size:"lg",onClick:()=>{E(!1),A([{id:crypto.randomUUID(),script:"",imageId:null,imageUrl:null,status:"pending"}])},children:"Start New Batch"})]}),(0,b.jsx)(bg.Dialog,{open:null!==G,onOpenChange:a=>!a&&I(null),children:(0,b.jsxs)(bg.DialogContent,{className:"max-w-2xl max-h-[80vh] flex flex-col",children:[(0,b.jsx)(bg.DialogHeader,{children:(0,b.jsx)(bg.DialogTitle,{children:"Select Portrait Image"})}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(H.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(r.Input,{placeholder:"Search images...",value:R,onChange:a=>{let b;return S(a.target.value),b=setTimeout(()=>ao(!1),300),()=>clearTimeout(b)},className:"pl-9"})]}),(0,b.jsx)("input",{ref:X,type:"file",accept:"image/*",onChange:ar,className:"hidden"}),(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",onClick:()=>X.current?.click(),disabled:T,children:[T?(0,b.jsx)(u.Loader2,{className:"h-4 w-4 mr-1 animate-spin"}):(0,b.jsx)(J.Upload,{className:"h-4 w-4 mr-1"}),"Upload"]})]}),am&&am.reference_images.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-xs font-medium mb-1.5",children:[am.name,"'s Reference Images"]}),(0,b.jsx)("div",{className:"flex gap-1.5 overflow-x-auto pb-1",children:am.reference_images.map(a=>(0,b.jsx)("button",{type:"button",className:"h-14 w-14 rounded-md overflow-hidden border-2 border-transparent hover:border-accent-blue/50 transition-all flex-shrink-0",onClick:()=>ap(a),children:(0,b.jsx)("img",{src:a.signed_url,alt:"",className:"h-full w-full object-cover"})},a.id))})]}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto min-h-0",children:[0!==L.length||P?(0,b.jsx)("div",{className:"grid grid-cols-4 sm:grid-cols-5 gap-2 pb-2",children:L.map(a=>(0,b.jsx)("button",{type:"button",className:"relative aspect-square overflow-hidden rounded-md border-2 border-transparent hover:border-accent-blue/50 transition-all",onClick:()=>ap(a),children:(0,b.jsx)("img",{src:a.signed_url,alt:a.filename,className:"h-full w-full object-cover",loading:"lazy"})},a.id))}):(0,b.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No images found."})}),L.length<N&&(0,b.jsx)("div",{className:"flex justify-center py-2",children:(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>ao(!0),disabled:P,children:P?(0,b.jsx)(u.Loader2,{className:"h-4 w-4 animate-spin"}):"Load More"})})]}),G&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Click an image to select it for this video. Uploaded images are auto-saved to your asset library."})]})}),(0,b.jsx)(bg.Dialog,{open:null!==ag,onOpenChange:a=>!a&&ah(null),children:(0,b.jsxs)(bg.DialogContent,{className:"max-w-lg",children:[(0,b.jsx)(bg.DialogHeader,{children:(0,b.jsx)(bg.DialogTitle,{children:"Re-caption Video"})}),(0,b.jsxs)("div",{className:"space-y-4 pt-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Choose new caption styles. This will regenerate the captioned video with your new settings."}),(0,b.jsx)(a7,{settings:ai,onChange:aj}),(0,b.jsxs)("div",{className:"flex gap-2 justify-end pt-2",children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>ah(null),disabled:ak,children:"Cancel"}),(0,b.jsxs)(e.Button,{onClick:ay,disabled:ak,children:[ak?(0,b.jsx)(u.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,b.jsx)(af,{className:"h-4 w-4 mr-2"}),ak?"Recaptioning...":"Apply New Captions"]})]})]})]})})]})}function bk({status:a,pollCount:c}){switch(a){case"pending":return(0,b.jsx)(f.Badge,{variant:"outline",className:"text-xs",children:"Pending"});case"generating_voice":return(0,b.jsxs)(f.Badge,{variant:"secondary",className:"text-xs gap-1",children:[(0,b.jsx)(u.Loader2,{className:"h-3 w-3 animate-spin"}),"Voice"]});case"uploading_audio":return(0,b.jsxs)(f.Badge,{variant:"secondary",className:"text-xs gap-1",children:[(0,b.jsx)(u.Loader2,{className:"h-3 w-3 animate-spin"}),"Upload"]});case"submitting":return(0,b.jsxs)(f.Badge,{variant:"secondary",className:"text-xs gap-1",children:[(0,b.jsx)(u.Loader2,{className:"h-3 w-3 animate-spin"}),"Submit"]});case"polling":return(0,b.jsxs)(f.Badge,{variant:"secondary",className:"text-xs gap-1",children:[(0,b.jsx)(u.Loader2,{className:"h-3 w-3 animate-spin"}),Math.round(3*(c||0)),"s"]});case"captioning":return(0,b.jsxs)(f.Badge,{variant:"secondary",className:"text-xs gap-1",children:[(0,b.jsx)(u.Loader2,{className:"h-3 w-3 animate-spin"}),"Captions"]});case"completed":return(0,b.jsxs)(f.Badge,{variant:"secondary",className:"text-xs gap-1 text-green-600",children:[(0,b.jsx)(D.CheckCircle2,{className:"h-3 w-3"}),"Done"]});case"failed":return(0,b.jsxs)(f.Badge,{variant:"destructive",className:"text-xs gap-1",children:[(0,b.jsx)(v.AlertCircle,{className:"h-3 w-3"}),"Failed"]})}}var bl=a.i(17545);function bm({aiModels:a,prefillVideoUrl:d}){return(0,b.jsxs)(c.Tabs,{defaultValue:"single",className:"space-y-4",children:[(0,b.jsxs)(c.TabsList,{children:[(0,b.jsxs)(c.TabsTrigger,{value:"single",className:"gap-1.5",children:[(0,b.jsx)(o.Video,{className:"h-3.5 w-3.5"}),"Single Video"]}),(0,b.jsxs)(c.TabsTrigger,{value:"bulk",className:"gap-1.5",children:[(0,b.jsx)(bl.Layers,{className:"h-3.5 w-3.5"}),"Bulk Generate"]})]}),(0,b.jsx)(c.TabsContent,{value:"single",children:(0,b.jsx)(bc,{aiModels:a,prefillVideoUrl:d})}),(0,b.jsx)(c.TabsContent,{value:"bulk",children:(0,b.jsx)(bj,{aiModels:a})})]})}a.s(["TalkingHeadTabs",()=>bm],7273)}];

//# sourceMappingURL=src_components_talking-head_talking-head-tabs_tsx_fb2664ba._.js.map